{"version":3,"sources":["DistroPlot.tsx","utils.ts"],"names":["NEIGHBOR_COLORS","params","getUrlParams","axisTicks","nPoints","length","valueKeys","Object","keys","filter","k","valueParams","zipmap","map","colorKeys","colorIndexMap","_","i","series","v","key","price","value","parseInt","sort","a","b","allData","reduce","rec","d","concat","getY","xScale","scaleBand","domain","paddingOuter","paddingInner","yScale","scaleLinear","max","tickLabelProps","fontSize","textAnchor","DistroPlot","debounceTime","className","width","height","scaleHeight","range","lineData","top","left","curve","curveBasis","data","x","getX","y","stroke","strokeWidth","strokeOpacity","shapeRendering","axisClassName","hideAxisLine","tickLength","scale","tickValues","includeTick","numTicks","arr1","arr2","p","c","url","decodeURI","window","location","href","question","indexOf","hash","query","substring","result","split","forEach","part","eq","join","substr","val","decodeURIComponent","from","to","index","push"],"mappings":"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","file":"static/js/7.7e06240b.chunk.js","sourcesContent":["import React from 'react';\nimport { max } from 'd3-array';\nimport { curveBasis } from '@visx/curve';\nimport { AxisBottom } from '@visx/axis';\nimport { ParentSize } from '@visx/responsive';\nimport { Group } from '@visx/group';\nimport { LinePath } from '@visx/shape';\nimport { scaleBand, scaleLinear } from '@visx/scale';\nimport {getUrlParams, zipmap} from \"./utils\";\nimport './DistroPlot.scss';\n\nexport const NEIGHBOR_COLORS = {\n    'c': '#ff931e',\n    'a': '#a064ff',\n    'n': '#3fa9f5',\n    'l': '#ff3fa0',\n};\n\nconst scalePadding = 32;\n\ninterface PriceValue {\n    price: string\n    value: number\n    key: string\n}\n\nconst params = getUrlParams();\nconst axisTicks = params['ax'];\nconst nPoints = axisTicks.length;\nconst valueKeys = Object.keys(params).filter((k) => k !== 'ax');\nconst valueParams = zipmap(valueKeys, valueKeys.map((k) => params[k]));\nconst colorKeys = Object.keys(NEIGHBOR_COLORS);\nconst colorIndexMap = zipmap(colorKeys, colorKeys.map((_, i) => i))\nconst series = Object.keys(valueParams).map((k =>\n    valueParams[k].map((v, i) => ({ key: k, price: axisTicks[i], value: parseInt(v) })))\n).sort((a, b) => colorIndexMap[a.key] - colorIndexMap[b.key]);\nconst allData = series.reduce((rec, d) => rec.concat(d), []);\n\nconst getX = (d: PriceValue) => d.price;\nconst getY = (d: PriceValue) => d.value;\n\nconst xScale = scaleBand<string>({\n    domain: axisTicks,\n    paddingOuter: 1,\n    paddingInner: 1,\n});\nconst yScale = scaleLinear<number>({\n    domain: [0, max(allData, getY) as number],\n});\n\nconst tickLabelProps = () =>\n({\n    fontSize: 14,\n    textAnchor: 'middle'\n} as const);\n\nconst includeTick = (i: number) => {\n    if (axisTicks.length % 2 === 0) {\n        return i > 0 && i < axisTicks.length - 2 && i % 2 === 0;\n    } else {\n        return i > 1 && i < axisTicks.length - 1 && i % 2 === 0;\n    }\n}\n\nconst DistroPlot = () => (\n    <ParentSize debounceTime={0} className='bg'>\n        {({ width, height }) => {\n            const scaleHeight = height - scalePadding;\n            xScale.range([0, width + 24]);\n            yScale.range([scaleHeight - 16, 0]);\n            return (\n                <svg width={width} height={height}>\n                    {width > 8 &&\n                    series.map((lineData, i) => {\n                        return (\n                            <Group key={`lines-${i}`} top={0} left={0}>\n                                <LinePath<PriceValue>\n                                    curve={curveBasis}\n                                    data={lineData}\n                                    x={d => xScale(getX(d)) ?? 0}\n                                    y={d => yScale(getY(d)) ?? 0}\n                                    stroke={NEIGHBOR_COLORS[lineData[0].key]}\n                                    strokeWidth={5}\n                                    strokeOpacity={0.875}\n                                    shapeRendering=\"geometricPrecision\"\n                                />\n                            </Group>\n                        );\n                    })}\n                    <AxisBottom\n                        axisClassName='axis'\n                        hideAxisLine={true}\n                        tickLength={2}\n                        top={scaleHeight}\n                        scale={xScale}\n                        tickLabelProps={tickLabelProps}\n                        tickValues={axisTicks.filter((_, i) => includeTick(i))}\n                        numTicks={nPoints}\n                    />\n                </svg>\n            );\n        }\n    }\n    </ParentSize>\n);\n\nexport default DistroPlot;","\nexport const zipmap = (arr1 ,arr2) => arr1.reduce((p,c,i) => {\n    p[c] = arr2[i];\n    return p;\n},{});\n\nexport const getUrlParams = () : any => {\n    const url = decodeURI(window.location.href);\n    const question = url.indexOf(\"?\");\n    let hash = url.indexOf(\"#\");\n    if (hash === -1 && question === -1) return {};\n    if (hash === -1) hash = url.length;\n    const query = question === -1 || hash === question + 1 ? url.substring(hash) :\n        url.substring(question+1,hash);\n    let result = {};\n    query.split(\"&\").forEach(function(part) {\n        if (!part) return;\n        part = part.split(\"+\").join(\" \"); // replace every + with space, regexp-free version\n        const eq = part.indexOf(\"=\");\n        let key = eq>-1 ? part.substr(0,eq) : part;\n        const val = eq>-1 ? decodeURIComponent(part.substr(eq + 1)) : \"\";\n        const from = key.indexOf(\"[\");\n        if (from === -1) result[decodeURIComponent(key)] = val;\n        else {\n            const to = key.indexOf(\"]\",from);\n            const index = decodeURIComponent(key.substring(from + 1,to));\n            key = decodeURIComponent(key.substring(0, from));\n            if (!result[key]) result[key] = [];\n            if (!index) result[key].push(val);\n            else result[key][index] = val;\n        }\n    });\n    return result;\n}\n"],"sourceRoot":""}