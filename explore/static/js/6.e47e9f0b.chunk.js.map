{"version":3,"sources":["dashboard/config.ts","dashboard/utils/misc.ts","features/data/dataSlice.ts","features/year/yearSlice.ts","features/plotType/plotTypeSlice.ts","features/controls/controlsSlice.ts","app/store.ts","hooks/useTouchOutside.ts","dashboard/CustomTooltipWithBounds.tsx","app/hooks.ts","dashboard/selectors.ts","hooks/useSelect.tsx","dashboard/utils/domain.ts","dashboard/BubblePlot.tsx","dashboard/MapPlot.tsx","dashboard/LinePlot.tsx","dashboard/BarPlot.tsx","dashboard/sharing.tsx","features/year/YearSlider.tsx","features/plotType/PlotTypeSelect.tsx","features/controls/Controls.tsx","dashboard/utils/dataSplitting.ts","features/data/DataManager.tsx","dashboard/Url.tsx","dashboard/Dashboard.tsx","utils.ts"],"names":["AxisLabelSource","FieldType","PLOT_TYPES","name","icon","BubbleChartIcon","xAxisLabelSource","VAR","fields","x","y","z","TimelineIcon","YEAR","BarChartIcon","COMPARE","RoomIcon","hideAxisLabels","PLOT_TYPES_MAP","zipObj","map","p","SHARE_SIZES","width","height","SHARE_SIZE_MAP","f","FIELD_CFGS","type","NUMERIC","group","DOLLARS","MINUTES","PERCENT","bind","xs","flatMap","as","a","concat","reduceRight","mergeDeepWithConcat","mergeDeepWith","Array","isArray","getNestedValues","obj","level","vals","Object","values","v","invertNestedObject","entries","reduce","acc","innerKey","forEach","outerKey","val","augmentField","id","dataSlice","createSlice","initialState","value","levels","byId","allIds","areas","years","byLevelAndField","divisions","byLevel","byFieldAndDivision","topologies","byAreaAndLevel","status","reducers","setData","state","action","data","newData","keys","processData","payload","actions","selectAreas","selectNumericFields","createSelector","filter","yearSlice","setYear","extraReducers","last","selectYear","year","plotTypeSlice","setPlotType","selectPlotType","plotType","urlParams","getUrlParams","area","compare","controlsSlice","setControl","key","setControls","store","configureStore","reducer","dataReducer","yearReducer","plotTypeReducer","controls","controlsReducer","useTouchOutside","elementRef","onClick","useEffect","clickListener","event","current","contains","target","document","addEventListener","removeEventListener","withBoundingRects","initialLeft","left","initialTop","top","offsetLeft","offsetTop","rect","parentRect","children","getRects","style","otherProps","transform","useAppDispatch","useDispatch","useAppSelector","useSelector","selectControlValues","cv","nfs","length","selectXyzControlValues","selectNonNullXyzControlArray","selectControlFields","mapObjIndexed","k","selectCurrentDivisions","dvsByLevel","selectYears","yblaf","cvs","xyz","intersection","tail","selectTopologies","tbaal","processDatasetItem","vbfad","field","selectCurrentDataset","byField","byYear","DEFAULT_OPTIONS","selectedOpacity","unselectedOpacity","defaultOpacity","groupByKeys","keyFields","items","im","groupBy","item","curry","lookupItem","itemMap","results","lookupKeys","Error","matchesAllKeys","keysToMatch","itemKeys","n","Math","min","all","i","range","formatValue","Number","toLocaleString","TooltipContent","className","useSelect","showLabel","disableInteraction","nKeyFields","React","useState","selectedKeys","selectKeys","useTooltip","tooltipOpen","tooltipLeft","tooltipTop","tooltipData","showTooltip","hideTooltip","select","useCallback","scaledX","scaledY","deselect","getKeys","key1","Tooltip","memo","ref","useRef","defaultTooltipStyles","fontSize","padding","margin","makeSelectable","keyValues","c","options","useSpring","animOpacity","setAnim","isSelected","opacity","animate","g","fillOpacity","to","strokeOpacity","join","cloneElement","props","makeInteractive","callback","resolvedKeyValues","Function","onTouchStart","onMouseMove","onMouseLeave","makeSelectableAndInteractive","concreteKeys","prepareData","dataByYear","dataArray","outerKeys","arrayLength","r","innerKeys","invertMapOfMaps","toPairs","allValuesNotNull","every","DumbBubblePlot","scaleFactor","xScale","scaleLinear","domain","extent","round","yScale","sizeScale","size","animX","animY","animSize","circle","cx","cy","fill","stroke","BubblePlot","projection","geoAlbersUsa","opacityOptions","DumbMapPlot","centerX","centerY","scale","unitedStates","topojson","objects","features","colorScale","hcl","interpolate","interpolateHcl","color","d","geoid","ifs","geoCentroid","AlbersUsa","translate","feature","path","animColor","strokeWidth","MapPlot","lineOptions","pointOptions","DumbLinePlot","useMemo","ds","yvs","a2","convertData","lines","lineKeys","max","circleSize","voronoiInstance","voronoi","findNearest","line","point","localPoint","find","LinePath","GlyphCircle","LinePlot","DumbBarPlot","hPadding","vPadding","tempItems","scaleBand","bandwidth","BarPlot","BaseDialog","setOpen","fullScreen","window","location","hash","onHashChange","Dialog","open","onClose","history","back","keepMounted","createPlotTitle","compareByVar","xAxisLabel","yAxisLabel","toLowerCase","DumbImageDialog","plot","label","setLabel","showAxisLabels","theme","useTheme","useMediaQuery","breakpoints","down","plotTitle","defaultShareSize","sharePresetSize","setSharePresetSize","previewSize","setPreviewSize","shareSize","setShareSize","format","setFormat","imgData","setImgData","canvasToPng","canvas","toDataURL","GenerateDialog","setNewSize","newSize","ratio","h1","w","calculatePreviewSize","DialogContent","FormControl","InputLabel","variant","htmlFor","NativeSelect","onChange","getElementsByClassName","scrollTo","s","FormGroup","row","TextField","helperText","FormControlLabel","control","Switch","DialogActions","Button","el","getElementById","compose","then","htmlToImage","getGenerateFn","canvasWidth","canvasHeight","quality","dataUrl","DownloadDialog","url","href","download","alt","src","PinterestShareButton","media","PinterestIcon","ImageDialog","ShareDialog","FacebookShareButton","quote","FacebookIcon","TwitterShareButton","title","TwitterIcon","RedditShareButton","RedditIcon","LinkedinShareButton","LinkedinIcon","display","onCopy","text","IconButton","PrettoSlider","styled","Slider","border","backgroundColor","boxShadow","lineHeight","background","borderRadius","transformOrigin","YearSlider","dispatch","Box","sx","flex","defaultValue","step","disabled","valueLabelDisplay","paddingTop","PlotTypeSelect","ToggleButtonGroup","exclusive","pt","ToggleButton","Controls","controlsIsReady","numericFields","numericFieldGroups","gs","groupFields","updateState","newState","FieldSelect","toUpperCase","Autocomplete","getOptionLabel","option","renderInput","params","SplittingDataFetcher","config","_computeChunkUrls","paramsToChunkUrls","u","BASE_CHUNK_URL","_fetchChunks","urls","axios","get","spread","responses","onChunkFetch","fetchChunks","this","DataManager","chunk","Url","storedYear","useQueryParams","StringParam","createEnumParam","NumberParam","query","setQuery","nonNullControls","allParams","setUseWhatChange","process","require","LoadingPlot","CircularProgress","PlotArea","loading","axisLabels","showPlot","sizeVar","yAxisVar","ParentSize","debounceTime","SideMenuItem","ListItem","button","ListItemIcon","ListItemText","primary","Collapse","in","timeout","unmountOnExit","DumbDashboard","prefersDarkMode","computeXAxisLabel","createTheme","palette","mode","main","sm","md","lg","xl","Plot","SideMenu","drawerOpen","setDrawerOpen","genImgOpen","setGenImgOpen","shareOpen","setShareOpen","setShowLabel","drawer","Divider","List","Hidden","xlUp","Drawer","ModalProps","xlDown","AppBar","position","elevation","Toolbar","edge","marginRight","spacing","Typography","fontWeight","useWhatChanged","ThemeProvider","CssBaseline","boxSizing","flexDirection","paddingLeft","Card","myHistory","push","pushState","replace","replaceState","Dashboard","DashboardApp","zipmap","arr1","arr2","decodeURI","question","indexOf","substring","result","split","part","eq","substr","decodeURIComponent","from","index"],"mappings":"qLAQYA,E,sKAAAA,O,aAAAA,I,qBAAAA,I,gBAAAA,M,KAkBL,IAiFKC,EAjFCC,EAAyB,CAAC,CACnCC,KAAM,SACNC,KAAMC,IACNC,iBAAkBN,EAAgBO,IAClCC,OAAQ,CACJC,EAAG,SACHC,EAAG,SACHC,EAAG,SAER,CACCR,KAAM,OACNC,KAAMQ,IACNN,iBAAkBN,EAAgBa,KAClCL,OAAQ,CAEJE,EAAG,WAER,CACCP,KAAM,MACNC,KAAMU,IACNR,iBAAkBN,EAAgBe,QAClCP,OAAQ,CAEJE,EAAG,WAER,CACCP,KAAM,MACNC,KAAMY,IACNC,gBAAgB,EAChBT,OAAQ,CACJE,EAAG,WAIEQ,EACTC,YAAOjB,EAAWkB,KAAI,SAAAC,GAAC,OAAIA,EAAElB,QAAOD,GAQ3BoB,EAA2B,CAAC,CACrCnB,KAAM,mBACNoB,MAAO,KACPC,OAAQ,MACT,CACCrB,KAAM,UACNoB,MAAO,KACPC,OAAQ,KACT,CACCrB,KAAM,YACNoB,MAAO,IACPC,OAAQ,MACT,CACCrB,KAAM,SACNoB,MAAO,KACPC,OAAQ,OAGCC,EACTN,YAAOG,EAAYF,KAAI,SAAAC,GAAC,OAAIA,EAAElB,QAAOmB,I,SAmB7BrB,O,qBAAAA,I,qBAAAA,I,qBAAAA,I,sBAAAA,M,KAqBL,IC1HOyB,ED0HDC,EAAgE,CACzE,UAAa,CACTC,KAAM3B,EAAU4B,QAChBC,MAAO,WAEX,aAAgB,CACZF,KAAM3B,EAAU8B,QAChBD,MAAO,WAEX,YAAe,CACXF,KAAM3B,EAAU8B,QAChBD,MAAO,WAEX,kBAAqB,CACjBF,KAAM3B,EAAU+B,QAChBF,MAAO,WAEX,cAAiB,CACbF,KAAM3B,EAAUgC,QAChBH,MAAO,WAEX,gBAAmB,CACfF,KAAM3B,EAAUgC,QAChBH,MAAO,WAEX,aAAgB,CACZF,KAAM3B,EAAUgC,QAChBH,MAAO,WAEX,gBAAmB,CACfF,KAAM3B,EAAUgC,QAChBH,MAAO,WAEX,cAAiB,CACbF,KAAM3B,EAAUgC,QAChBH,MAAO,WAEX,eAAkB,CACdF,KAAM3B,EAAUgC,QAChBH,MAAO,Y,+DCpKTI,EAAO,SAAAC,GAAE,OAAI,SAAAT,GAAC,OAAIS,EAAGC,QAAQV,MAGrBA,EAIV,SAAAS,GAAE,OAAI,SAAAE,GAAE,OACJH,EAAKG,EAALH,EACI,SAAAzB,GAAC,OAAIyB,EAAKC,EAALD,EACD,SAAAI,GAAC,MAAI,CACD,CAACA,GAAGC,OAAO9B,YARZ,SAAA6B,GAAC,OAAI,SAAAH,GAAE,OACtBA,EAAGK,aAAY,SAACF,EAAG7B,GAAJ,OAAUiB,EAAEjB,EAAFiB,CAAKY,KAAIA,MAWpC,CACE,KASG,IAAMG,EAAsBC,aAAc,SAACjC,EAAGC,GAAJ,OAAUiC,MAAMC,QAAQnC,GAAK8B,YAAO9B,EAAGC,GAAKA,KAIhFmC,EAAkB,SAAlBA,EAAmBC,GAA4C,IAA/BC,EAA8B,uDAAd,EACnDC,EAAOC,OAAOC,OAAOJ,GAC3B,OAAIC,EAAQ,EACDC,EAAKZ,SAAQ,SAAAe,GAAC,OAAIN,EAAgBE,EAAQ,EAAGI,MAE7CH,EAAKZ,SAAQ,SAAAe,GAAC,OAAIF,OAAOC,OAAOC,OAkBlCC,EAAqB,SAAA3C,GAC9B,OAAY,MAALA,GAAoC,MAAvBwC,OAAOC,OAAOzC,GAAG,GAAa,KAC9CwC,OAAOI,QAAQ5C,GAAG6C,QAAO,SAACC,EAAD,GAA2B,IAAD,mBAAnBC,EAAmB,KAATV,EAAS,KAK/C,OAJAG,OAAOI,QAAQP,GAAKW,SAAQ,YAAsB,IAAD,mBAAnBC,EAAmB,KAATC,EAAS,KAC7CJ,EAAIG,GAAYH,EAAIG,IAAa,GACjCH,EAAIG,GAAUF,GAAYG,KAEvBJ,IACR,K,SCxBLK,EAAe,SAAClC,GAAD,mBAAC,eACbA,GAAMC,EAAWD,EAAEmC,MA6BfC,EAAYC,YAAY,CACjC5D,KAAM,OACN6D,aA7C4B,CAC5BC,MAAO,CACHC,OAAQ,CAACC,KAAM,GAAIC,OAAQ,IAC3BC,MAAO,CAACF,KAAM,GAAIC,OAAQ,IAC1B5D,OAAQ,CAAC2D,KAAM,GAAIC,OAAQ,IAC3BE,MAAO,CAACC,gBAAiB,IACzBC,UAAW,CAACC,QAAS,IACrBvB,OAAQ,CAACwB,mBAAoB,IAC7BC,WAAY,CAACC,eAAgB,KAEjCC,OAAQ,QAqCRC,SAAU,CAENC,QAAS,SAACC,EAAOC,GACb,IAAMC,EA/BE,SAACA,GAEjB,IAAMC,EAAa,eAAOD,GAmB1B,OAlBMA,EAAKb,QACPc,EAAO,MAAY,CACfhB,KAAMe,EAAKb,MACXD,OAAQnB,OAAOmC,KAAKF,EAAKb,SAG3Ba,EAAKhB,SACPiB,EAAO,OAAa,CAChBhB,KAAMe,EAAKhB,OACXE,OAAQnB,OAAOmC,KAAKF,EAAKhB,UAG3BgB,EAAK1E,SACP2E,EAAO,OAAa,CAChBhB,KAAM/C,YAAIwC,EAAcsB,EAAK1E,QAC7B4D,OAAQnB,OAAOmC,KAAKzD,KAGrBwD,EAUcE,CAAYJ,EAAOK,SAChCN,EAAMf,MAAQxB,EAAoBuC,EAAMf,MAAOiB,OAK5CH,EAAYjB,EAAUyB,QAAtBR,QAEFS,EAAc,SAACR,GAAD,uBAAsBA,EAAME,KAAKjB,aAAjC,aAAsB,EAAkBI,OAYtDoB,EAAsBC,aAbT,SAACV,GAAD,OAAsBA,EAAME,KAAKjB,SAevD,SAACiB,GACG,OAAOA,EAAK1E,OAAS0E,EAAK1E,OAAO4D,OAC5BhD,KAAI,SAAAyC,GAAE,OAAIqB,EAAK1E,OAAO2D,KAAKN,MAC3B8B,QAAO,SAAAjE,GAAC,OACLA,EAAEE,OAAS3B,EAAU4B,SACrBH,EAAEE,OAAS3B,EAAU8B,SACrBL,EAAEE,OAAS3B,EAAU+B,SACrBN,EAAEE,OAAS3B,EAAUgC,WACrB,QAID6B,IAAf,QC9Fa8B,EAAY7B,YAAY,CACnC5D,KAAM,OACN6D,aAP8B,CAC9BC,MAAO,KACPY,OAAQ,QAMRC,SAAU,CACRe,QAAS,SAACb,EAAOC,GACf,IAAMhB,EAAQgB,EAAOK,QACR,MAATrB,GAAiBA,IAAUe,EAAMf,QACjCe,EAAMf,MAAQA,KAItB6B,cAAc,eAEXhC,EAAUyB,QAAQR,SAAU,SAACC,EAAOC,GACnC,IAAMC,EAAOD,EAAOK,QAIpB,GAAIJ,EAAKZ,MAAO,CAMdU,EAAMf,MAAQ8B,YAAKb,EAAKZ,MAAMC,gBAAX,uBAMZsB,EAAYD,EAAUL,QAAtBM,QACFG,EAAa,SAAChB,GAAD,OAAsBA,EAAMiB,KAAKhC,OAC5C2B,IAAf,QClCaM,EAAgBnC,YAAY,CACrC5D,KAAM,WACN6D,aAPgC,CAChCC,MAAO,MACPY,OAAQ,QAORC,SAAU,CAENqB,YAAa,SAACnB,EAAOC,GACjB,IAAMhB,EAAQgB,EAAOK,QACR,MAATrB,GAA2B,KAAVA,IACjBe,EAAMf,MAAQA,OAKfkC,EAAgBD,EAAcX,QAA9BY,YACFC,EAAiB,SAACpB,GAAD,OAAsB9D,EAAe8D,EAAMqB,SAASpC,QACnEiC,KAAf,Q,SCTMI,GAAYC,eAEZvC,GAA8B,CAChCC,MAAO,CACHuC,KAAM,KACNC,QAAS,QACThG,EAAG6F,GAAU7F,EACbC,EAAG4F,GAAU5F,EACbC,EAAG2F,GAAU3F,IAIR+F,GAAgB3C,YAAY,CACrC5D,KAAM,WACN6D,gBAEAc,SAAU,CAEN6B,WAAY,SAAC3B,EAAOC,GAChBD,EAAMf,MAAMgB,EAAOK,QAAQsB,KAAO3B,EAAOK,QAAQrB,OAErD4C,YAAa,SAAC7B,EAAOC,GACjBD,EAAMf,MAAN,2BAAkBe,EAAMf,OAAUgB,EAAOK,aAK9C,GAAoCoB,GAAcnB,QAA1CoB,GAAR,GAAQA,WAAYE,GAApB,GAAoBA,YAMZH,MAAf,QChDaI,GAAQC,YAAe,CAClCC,QAAS,CACP9B,KAAM+B,EACNhB,KAAMiB,EACNb,SAAUc,GACVC,SAAUC,M,sRCcCC,GAvBS,SAACC,EAAYC,GACjCC,qBAAU,WACN,IAAMC,EAAgB,SAAAC,GACbJ,EAAWK,UAAWL,EAAWK,QAAQC,SAASF,EAAMG,SAG7DN,EAAQG,IAUZ,OAFAI,SAASC,iBAAiB,aAAcN,GAEjC,WACHK,SAASE,oBAAoB,aAAcP,MAGhD,CAACH,EAAYC,K,yHC2BLU,qBA7Cf,YAWqC,IAVMC,EAUP,EAVCC,KACKC,EASN,EATCC,IASD,IARCC,kBAQD,MARc,GAQd,MAPCC,iBAOD,MAPa,GAOb,EANCC,EAMD,EANCA,KACAC,EAKD,EALCA,WAEAC,GAGD,EAJCC,SAID,EAHCD,UACAE,EAED,EAFCA,MACGC,EACJ,mBAE5BV,EAAOD,EACPG,EAAMD,EAsBV,OApBIK,IACIA,EAAWnH,MAAQ,IACf6G,EAAOG,EAAaE,EAAKlH,MAAQmH,EAAWnH,QAC5C6G,EAAOM,EAAWnH,MAAQkH,EAAKlH,MAAQgH,GAEvCH,EAAO,IACPA,EAAO,IAIXM,EAAWlH,OAAS,IAChB8G,EAAME,EAAYC,EAAKjH,OAASkH,EAAWlH,SAC3C8G,EAAMI,EAAWlH,OAASiH,EAAKjH,OAASgH,GAExCF,EAAM,IACNA,EAAM,KAMd,eAAC,KAAD,yBACIO,MAAK,aAAIP,IAAK,EAAGS,UAAU,aAAD,OAAeX,EAAf,eAA0BE,EAA1B,QAAuCO,IAC7DC,GAFR,aAIKH,QCzCAK,GAAiB,kBAAMC,eACvBC,GAAkDC,I,UCUlDC,GAAsB1D,aLmCM,SAACV,GACtC,OAAOA,EAAMoC,SAASnD,QKlCtBwB,GACA,SAAC4D,EAAIC,GACD,OAAKA,GAAsB,IAAfA,EAAIC,OAGT,2BACAF,GADP,IAEI5I,EAAG4I,EAAG5I,GAAK6I,EAAI,GAAGzF,GAClBnD,EAAG2I,EAAG3I,GAAK4I,EAAI,GAAGzF,GAClBlD,EAAG0I,EAAG1I,GAAK2I,EAAI,GAAGzF,KANXwF,KAWNG,GAAyB9D,YAClC0D,IACA,SAACC,GAAD,MAAS,CACL5I,EAAG4I,EAAG5I,EACNC,EAAG2I,EAAG3I,EACNC,EAAG0I,EAAG1I,MAID8I,GAA+B/D,YACxC8D,IACA,SAACH,GAAD,OAAQpG,OAAOC,OAAOmG,GAAI1D,QAAO,SAAAxC,GAAC,QAAMA,QAG/BuG,GAAsBhE,YAC/BF,GRwCwB,SAACR,GAAD,uBAAsBA,EAAME,KAAKjB,aAAjC,aAAsB,EAAkBC,UADxC,SAACc,GAAD,uBAAsBA,EAAME,KAAKjB,aAAjC,aAAsB,EAAkBzD,SQpChE4I,IACA,SAAC/E,EAAOH,EAAQ1D,EAAQ0C,GACpB,OAAOyG,cAAc,SAACxG,EAAGyG,GACrB,OAAKpJ,GAAW2C,EAGN,SAANyG,EACOvF,EAAMF,KAAKhB,GAEZ,YAANyG,EACO1F,EAAOC,KAAKhB,GAEZ3C,EAAO2D,KAAKhB,GARZ,OAUZD,MAIE2G,GAAyBnE,aRwBA,SAACV,GAAD,uBAClCA,EAAME,KAAKjB,aADuB,aAClC,EAAkBO,UAAUC,UQvB5B2E,IACA,SAACU,EAAYT,GAAb,OACIS,EAAWT,EAAG5C,YAGTsD,GAAcrE,aRee,SAACV,GAAD,uBACtCA,EAAME,KAAKjB,aAD2B,aACtC,EAAkBK,MAAMC,kBQdxB6E,GACAK,IACA,SAACO,EAAOC,EAAKC,GACT,OAAIjH,OAAOmC,KAAK4E,GAAOT,OAAS,GTjDXpH,ESkDG+H,EAAI9I,KAAI,SAAAiI,GAAE,OAAIW,EAAMC,EAAIxD,SAAS4C,MTlD7B/F,YAAO6G,IAAchI,EAAG,GAAIiI,YAAKjI,KSoDlD,GTpDS,IAACA,KSyDhBkI,GAAmB3E,aRAc,SAACV,GAAD,uBAC1CA,EAAME,KAAKjB,aAD+B,aAC1C,EAAkBU,WAAWC,iBQC7BwE,IACA,SAACkB,EAAOL,GACJ,OAAIhH,OAAOmC,KAAKkF,GAAOf,OAAS,EACrBe,EAAML,EAAIzD,MAAMyD,EAAIxD,SAEpB,QAKb8D,GAAqB,SAACC,EAAOC,GAC/B,OAAOA,EAAQrH,EAAmBoH,EAAMC,IAAU,MAGzCC,GAAuBhF,aRVU,SAACV,GAAD,uBAC1CA,EAAME,KAAKjB,aAD+B,aAC1C,EAAkBf,OAAOwB,qBQWzB0E,IACA,SAACoB,EAAOnB,GAAR,MAAgB,CACZsB,QAAS,CACLlK,EAAG+J,EAAMnB,EAAG5I,GACZC,EAAG8J,EAAMnB,EAAG3I,GACZC,EAAG6J,EAAMnB,EAAG1I,IAEhBiK,OAAQxH,EAAmB,CACnB3C,EAAG8J,GAAmBC,EAAOnB,EAAG5I,GAChCC,EAAG6J,GAAmBC,EAAOnB,EAAG3I,GAChCC,EAAG4J,GAAmBC,EAAOnB,EAAG1I,SC7F1CkK,GAAkB,CACpBC,gBAAiB,GACjBC,kBAAmB,IACnBC,eAAgB,IAMdC,GAAc,SAAdA,EAAeC,EAAqBC,GACtC,IAAMC,EAAKC,cAAQ,SAAAC,GAAI,OAAIA,EAAKJ,EAAU,MAAKhI,aAAOiI,IACtD,OAAyB,IAArBD,EAAU3B,OACH6B,EAEAhK,YAAImK,aAAMN,EAANM,CAAmBnB,YAAKc,IAAaE,IAQlDI,GAAa,SAACpG,EAAgBqG,GAChC,IAAMC,EALS,SAACtG,EAAgBqG,GAChC,OAAOnI,aAAO,SAAC8H,EAAIxB,GAAL,OAAWwB,EAAGxB,KAAI6B,EAASrG,GAIzBuG,CAAWvG,EAAMqG,GACjC,GAAuB,IAAnBC,EAAQnC,OACR,OAAOmC,EAAQ,GAEf,MAAM,IAAIE,MAAJ,gBAAmBF,EAAQnC,OAA3B,kCAA2DnE,KAInEyG,GAAiB,SAACC,EAAuBC,GAC3C,IAAMC,EAAIC,KAAKC,IAAIJ,EAAYvC,OAAQwC,EAASxC,QAGhD,OAAO4C,aAAI,SAAAC,GAAC,OAAIN,EAAYM,IAAML,EAASK,KAAIC,YAAM,EAAGL,KAGtDM,GAAc,SAAC7B,EAAkBxG,GACnC,IAAMN,EAAM4I,OAAOtI,GAAOuI,iBAC1B,OAAI/B,EAAM7I,OAAS3B,EAAU8B,QAClB,IAAM4B,EACN8G,EAAM7I,OAAS3B,EAAU+B,QACzB2B,EAAM,WACN8G,EAAM7I,OAAS3B,EAAUgC,QACzB0B,EAAM,IAENA,GAIT8I,GAAiB,SAAC,GAAY,IAAXnB,EAAU,EAAVA,KACflE,EAAW8B,GAAeQ,IAC1BrD,EAAW6C,GAAe9C,GAChC,OACI,uBAAKsG,UAAU,kBAAf,UACI,uBAAKA,UAAU,gBAAf,UACI,8BAAKpB,EAAKnL,OACV,sBAAKuM,UAAU,OAAf,SAAuBpB,EAAKrF,UAEhC,uBAAKyG,UAAU,eAAf,UACI,iCAAMtF,EAAS1G,EAAEP,KAAjB,KAAyBmM,GAAYlF,EAAS1G,EAAG4K,EAAK5K,MACrD2F,EAAS7F,OAAOC,GACb,iCAAM2G,EAAS3G,EAAEN,KAAjB,KAAyBmM,GAAYlF,EAAS3G,EAAG6K,EAAK7K,aAgJ3DkM,GAzIG,SAACxB,EAAcD,EACd0B,GAA2C,IAAhCC,EAA+B,wDACnDC,EAAa5B,EAAU3B,OACvBkC,EAAUR,GAAYC,EAAWC,GACvC,EAAmC4B,IAAMC,SAAmB,MAA5D,mBAAOC,EAAP,KAAqBC,EAArB,KACA,EAOIC,eANAC,EADJ,EACIA,YACAC,EAFJ,EAEIA,YACAC,EAHJ,EAGIA,WACAC,EAJJ,EAIIA,YACAC,EALJ,EAKIA,YACAC,EANJ,EAMIA,YAGEC,EAASX,IAAMY,aACjB,SAAC5B,GACG,IAAKkB,IAAiBpB,GAAeoB,EAAclB,GAAW,CAC1DmB,EAAWnB,GACX,IAAMT,EAAOE,GAAWO,EAAUN,GAClC+B,EAAY,CACRD,YAAa,eAAC,GAAD,CAAgBjC,KAAMA,IACnC+B,YAAa/B,EAAKsC,QAClBN,WAAYhC,EAAKuC,aAI7B,CAACL,EAAa/B,EAASwB,IAGrBa,EAAWf,IAAMY,aAAY,WAC/BT,EAAW,MACXO,MACD,CAACA,IAEEM,EAAU,SAACC,GACb,OAAQlB,GACJ,KAAK,EAAG,MAAO,CAACkB,GAChB,KAAK,EAAG,MAAO,CAACA,EAAMjI,YAAKX,aAAKqG,EAAQuC,MACxC,QAAS,MAAM,IAAIpC,MAAM,0BAA4BkB,KAI7DC,IAAMtF,WAAU,WACRmF,GACAc,EAAOK,EAAQnB,OAIvB,IAAMqB,EAAUlB,IAAMmB,MAAK,WACvB,IAAMC,EAAMpB,IAAMqB,OAAO,MAIzB,OADA9G,GAAgB6G,EAAKL,GACdP,EACH,qCACKH,GAAeG,GAEZ,eAAC,GAAD,CACIjF,IAAKgF,EACLlF,KAAMiF,EACNxE,MAAK,2BACEwF,MADF,IAEDC,SAAU,MACVC,QAAS,QACTC,OAAQ,WAEZ9B,UAAU,8BATd,SAWI,sBAAKyB,IAAKA,EAAV,SACKZ,QAKjB,QAGFkB,EAAiB1B,IAAMY,aAAY,SAACe,EAAkBC,GAAiC,IAA9BC,EAA6B,uDAApB/D,GAEpE,EAAmCgE,sBAAU,iBAAO,CAChDC,YAAaF,EAAQ5D,mBADzB,mBAAS8D,EAAT,KAASA,YAAeC,EAAxB,KAGMC,EAAa/B,GAAgBpB,GAAeoB,EAAcyB,GAC1DO,EAAUD,EAAaJ,EAAQ9D,gBAAkBmC,EAAe2B,EAAQ7D,kBAAoB6D,EAAQ5D,eACpGkE,EAA6B,MAAnBN,EAAQM,UAAuC,IAApBN,EAAQM,QACnD,OAAIA,GACAH,EAAQ,CAACD,YAAaG,IAOlB,eAAC,YAASE,EAAV,CACIC,YAAaN,EAAYO,IAAG,SAAA5O,GAAC,OAAIA,KACjC6O,cAAeR,EAAYO,IAAG,SAAA5O,GAAC,OAAIA,KAFvC,SAKKkO,GAFID,EAAUa,KAAK,OAMrBxC,IAAMyC,aAAab,EAAnB,2BACAA,EAAEc,OADF,IAEH7I,IAAK8H,EAAUa,KAAK,KACpBH,YAAaH,EACbK,cAAeL,OAGxB,CAAChC,IAEEyC,EAAkB3C,IAAMY,aAAY,SAACe,EAAuBC,GAC9D,GAAI9B,EACA,OAAO8B,EAEP,IAAMgB,EAAW,SAAChI,GACd,IAAMiI,EAAoBlB,EAAUtN,KAAI,SAAAwI,GAAC,OAAIA,aAAaiG,SAAWjG,EAAEjC,GAASiC,KAChF8D,EAAOkC,IAEX,OAAO7C,IAAMyC,aAAab,EAAnB,2BACAA,EAAEc,OADF,IAEHK,aAAcH,EACdI,YAAaJ,EACbK,aAAclC,OAGvB,CAACJ,EAAQI,EAAUjB,IAEhBoD,EAA+BlD,IAAMY,aACnC,SAACe,EAAuBC,GAAiC,IAA9BC,EAA6B,uDAApB/D,GAC1BqF,EAAexB,EAAU/I,QAAO,SAAAiE,GAAC,QAAMA,aAAaiG,aAClE,OAAOH,EAAgBhB,EAAWD,EAAeyB,EAAcvB,EAAGC,MACnE,CAACH,EAAgBiB,IAEpB,MAAO,CAACjB,iBAAgBiB,kBAAiBO,+BAA8BhC,Y,UC/N9DkC,GAAc,SAACC,EAAYnK,GACpC,IAAMoK,EXoCqB,SAC3BvN,GAEA,IAAMwN,EAAYrN,OAAOmC,KAAKtC,GAC9B,GAAyB,IAArBwN,EAAU/G,OACV,MAAO,GACX,IAAMgH,EAActN,OAAOC,OAAOJ,EAAIwN,EAAU,KAAK/G,OACrD,IAAK4C,aAAI,SAAAvC,GAAC,OAAI3G,OAAOC,OAAOJ,EAAI8G,IAAIL,SAAWgH,IAAaD,GACxD,MAAM,IAAI1E,MAAM,uCACpB,IAAM4E,EAAInE,YAAM,EAAGkE,GACbE,EAAYxN,OAAOmC,KAAKtC,EAAIwN,EAAU,KACtCtN,EAAOwN,EAAEpP,KAAI,SAAAgL,GAAC,OAAIjL,YAAOmP,EAAWA,EAAUlP,KAAI,SAAAwI,GAAC,OAAI9G,EAAI8G,GAAG6G,EAAUrE,WAC9E,OAAOjL,YAAOsP,EAAWzN,GWhDP0N,CAAgBN,EAAWnK,IAC7C,OAAO0K,aAAQvP,aAAI,SAAA+B,GAAC,kCACbA,GADa,IAEhB8C,WACAoK,KAGKO,GAAmB,SAAC9N,GAAD,OAC5BG,OAAOC,OAAOJ,GAAK+N,OAAM,SAAAnP,GAAC,OAAS,MAALA,MCS5BoP,GAAiB,SAAC,GAQjB,IAPH5L,EAOE,EAPFA,KAOE,IANF0H,iBAME,MANU,KAMV,MALFC,0BAKE,SAJFtL,EAIE,EAJFA,MACAC,EAGE,EAHFA,OACAyE,EAEE,EAFFA,KACAzB,EACE,EADFA,UAEMuM,EAAc9E,KAAKC,IAAI3K,EAAOC,GAAU,IACxC+M,EApBS,GAoBCtC,KAAKC,IAAI3K,EAAOC,GAC1BwP,EAASC,aAAoB,CAC/BC,OAAQC,aAAOtO,EAAgBqC,EAAKyF,QAAQlK,IAC5C4L,MAAO,CAACkC,EAAShN,EAAQgN,GACzB6C,OAAO,IAELC,EAASJ,aAAoB,CAC/BC,OAAQC,aAAOtO,EAAgBqC,EAAKyF,QAAQjK,IAC5C2L,MAAO,CAAC7K,EAAS+M,EAAU,EAAGA,GAC9B6C,OAAO,IAELE,EAAYL,aAAoB,CAClCC,OAAQC,aAAOtO,EAAgBqC,EAAKyF,QAAQhK,IAC5C0L,MAAO,CAAC0E,EAA2B,GAAdA,KAEnB5F,EAAQgF,GAAYjL,EAAK0F,OAAQ3E,GAClC7E,KAAI,mCAAEwI,EAAF,KAAKzG,EAAL,wBAAC,2BACCqB,EAAUoF,IACVzG,GAFF,IAGDyK,QAASoD,EAAO7N,EAAE1C,GAClBoN,QAASwD,EAAOlO,EAAEzC,GAClB6Q,KAAMD,EAAUnO,EAAExC,QAG1B,EACIgM,GAAUxB,EAAO,CAAC,QAASyB,EAAWC,GADnCoD,EAAP,EAAOA,6BAA8BhC,EAArC,EAAqCA,QAErC,OACI,uCACI,sBAAK1M,MAAOA,EAAOC,OAAQA,EAA3B,SACK2J,EAAM/J,KAAI,SAAAkK,GAEP,MAA4CuD,sBAAU,iBAAO,CACzD2C,MAAOlG,EAAKsC,QACZ6D,MAAOnG,EAAKuC,QACZ6D,SAAUpG,EAAKiG,SAHnB,0BAAQC,EAAR,EAAQA,MAAOC,EAAf,EAAeA,MAAOC,EAAtB,EAAsBA,SAYtB,OANA3C,EANA,MAMQ,CACJyC,MAAOlG,EAAKsC,QACZ6D,MAAOnG,EAAKuC,QACZ6D,SAAUpG,EAAKiG,OAGZtB,EAA6B,CAAC3E,EAAKnL,MACtC,eAAC,YAASwR,OAAV,CACIC,GAAIJ,EACJK,GAAIJ,EACJjB,EAAGkB,EACHI,KAAM,YACNC,OAAQ,kBAKxB,eAAC9D,EAAD,QAYG+D,GAPI,SAACvC,GAChB,IAAMxJ,EAAOiD,GAAelD,GACtBxB,EAAY0E,GAAeW,IACjC,OAAO5D,GAAQzB,GACX,eAAC,GAAD,2BAAoBiL,GAApB,IAA2BxJ,KAAMA,EAAMzB,UAAWA,M,gSC5DpDyN,GAAaC,eAEbC,GAAiB,CACnBrH,gBAAiB,EACjBC,kBAAmB,GACnBC,eAAgB,GAGdoH,GAAc,SAAC,GACwD,IADtDlN,EACqD,EADrDA,KAAM3D,EAC+C,EAD/CA,MAAOC,EACwC,EADxCA,OAAQyE,EACgC,EADhCA,KAAMzB,EAC0B,EAD1BA,UAAWG,EACe,EADfA,WACe,IAAnDiI,iBAAmD,MAAvC,KAAuC,MAAjCC,0BAAiC,SAClEwF,EAAU9Q,EAAQ,EAClB+Q,EAAU9Q,EAAS,EACnB+Q,EAAQtG,KAAKmF,MAAgC,IAA1BnF,KAAKC,IAAI3K,EAAOC,IAGvBgR,EAAiBC,KAAiB9N,EAAYA,EAAW+N,QAAQxN,MAA3EyN,SAKFC,EAAa3B,eACdC,OAAOC,aAAOtO,EAAgBqC,EAAKyF,QAAQjK,KAE3C2L,MAAM,CACHwG,aAAI,wBACJA,aAAI,aAEPC,YAAYC,MAEX5H,EAAQwF,aAAQzL,EAAK0F,OAAO3E,GAAMvF,GACnCU,KAAI,mCAAEwI,EAAF,KAAKlJ,EAAL,wBAAC,eACC8D,EAAUoF,IADZ,IAEDlJ,IACAuF,OACA+M,MAAOJ,EAAWlS,QAEpB+K,EAAUtK,YAAOgK,EAAM/J,KAAI,SAAA6R,GAAC,OAAIA,EAAEC,SAAQ/H,GAE1CgI,EAAMX,EACPpR,KAAI,SAACM,GACF,IAAMiN,EAAIsD,GAAWmB,aAAY1R,IACjC,OAAO,2BACA+J,EAAQ/J,EAAEmC,KADjB,IAEI+J,QAASe,EAAE,GAAK,KAChBd,QAASc,EAAE,GAAK,UAI5B,EACIhC,GAAUwG,EAAK,CAAC,QAASvG,EAAWC,GADjCoD,EAAP,EAAOA,6BAA8BhC,EAArC,EAAqCA,QAGrC,OAAO1M,EAAQ,GAAK,KAChB,uCACI,sBAAKA,MAAOA,EAAOC,OAAQA,EAA3B,SACI,eAAC6R,GAAA,EAAD,CACInO,KAAMsN,EACND,MAAOA,EACPe,UAAW,CAACjB,EAASC,GAHzB,SAKK,qBAAGK,SAEKvR,KAAI,YAAwB,IAArBmS,EAAoB,EAApBA,QAASC,EAAW,EAAXA,KACPlI,EAAOG,EAAQ8H,EAAQ1P,IAG7B,EAAiCgL,sBAAU,iBAAO,CAC9C4E,UAAWnI,EAAK0H,UADpB,mBAASS,EAAT,KAASA,UAOT,OAHA1E,EAJA,MAIQ,CACJ0E,UAAWnI,EAAK0H,QAEb/C,EAA6B,CAAC3E,EAAKnL,MACtC,eAAC,YAASqT,KAAV,CACIP,EAAGO,GAAQ,GACX1B,KAAM2B,EAAUpE,IAAG,SAAA5O,GAAC,OAAIA,KACxBsR,OA7Fb,OA8Fa2B,YAAa,IACbvB,YAM5B,eAAClE,EAAD,QAaG0F,GARC,SAAClE,GACb,IAAMxJ,EAAOiD,GAAelD,GACtBxB,EAAY0E,GAAeW,IAC3BlF,EAAauE,GAAemB,IAClC,OAAOpE,GAAQzB,GAAaG,GAC1B,eAAC,GAAD,2BAAiB8K,GAAjB,IAAwBxJ,KAAMA,EAAMzB,UAAWA,EAAWG,WAAYA,M,wCCzGtEiP,GAAc,CAChB9I,gBAAiB,GACjBC,kBAAmB,IACnBC,eAAgB,IAGd6I,GAAe,CACjB/I,gBAAiB,EACjBC,kBAAmB,EACnBC,eAAgB,EAChBkE,SAAS,GAcP4E,GAAe,SAAC,GAOf,IANH5O,EAME,EANFA,KAME,IALF0H,iBAKE,MALU,KAKV,MAJFC,0BAIE,SAHFtL,EAGE,EAHFA,MACAC,EAEE,EAFFA,OACAgD,EACE,EADFA,UAEM+J,EAAUxB,IAAMgH,SAAQ,iBA1Cf,KA2CP9H,KAAKC,IAAI3K,EAAOC,KACpB,CAACD,EAAOC,IAEN6O,EAvBU,SAAC2D,GACjB,IAAM1R,EAAIqH,cAAc,SAACsK,EAAKpQ,GAAN,OAChB8F,cAAc,SAACjJ,EAAGuF,GAAJ,MAAc,CACxBpC,KACAoC,OACAvF,OACAuT,KACND,GACN,OAAO/Q,OAAOC,OAAOZ,GAAGF,SAAQ,SAAA8R,GAAE,OAAIjR,OAAOC,OAAOgR,MAelCC,CAAYjP,EAAKyF,QAAQjK,GAErCsQ,EAASC,aAAoB,CAC/BC,OAAQC,aAAOd,GAAW,SAAA4C,GAAC,OAAKA,EAAEhN,QAClCoG,MAAO,CAACkC,EAAShN,EAAQgN,GACzB6C,OAAO,IAELC,EAASJ,aAAoB,CAC/BC,OAAQC,aAAOd,GAAW,SAAA4C,GAAC,OAAKA,EAAEvS,KAClC2L,MAAO,CAAC7K,EAAS+M,EAASA,GAC1B6C,OAAO,IAELjG,EAAQkF,EACTjP,KAAI,SAAA6R,GAAC,8CACCzO,EAAUyO,EAAEpP,KACZoP,GAFD,IAGFrF,QAASoD,EAAOiC,EAAEhN,MAClB4H,QAASwD,EAAO4B,EAAEvS,QAGpB0T,EAAQ/I,cAAQ,SAAA4H,GAAC,OAAIA,EAAE9S,OAAMgL,GAC7BkJ,EAAWpR,OAAOmC,KAAKgP,GAC7B,EACIzH,GAAUxB,EAAO,CAAC,OAAQ,QAASyB,EAAWC,GAD3C4B,EAAP,EAAOA,eAAgBwB,EAAvB,EAAuBA,6BAA8BhC,EAArD,EAAqDA,QAI/CyF,EAAczH,KAAKqI,IAAIrI,KAAKmF,MAAM7P,EAAQ,KAAM,GAChDgT,EAAatI,KAAKmF,MAAoB,GAAdsC,GAExBc,EAAkBC,aAAQ,CAC5BhU,EANY,SAACwS,GAAD,OAAOA,EAAErF,SAOrBlN,EANY,SAACuS,GAAD,OAAOA,EAAEpF,SAOrBtM,QACAC,WAGEkT,EAAc,SAACC,EAAMhN,GACvB,IAAMiN,EAAQC,aAAWlN,GAEzB,OADgB6M,EAAgBG,GAAMG,KAAKF,EAAMnU,EAAGmU,EAAMlU,GAAGwE,KAC9Ce,MAGnB,OACI,uCACI,sBAAK1E,MAAOA,EAAOC,OAAQA,EAA3B,SACI,qCACK6S,EAASjT,KAAI,SAACwF,GACX,IAAM+N,EAAOP,EAAMxN,GACnB,OACI,+BACKqJ,EAA6B,CAAC0E,EAAK,GAAGxU,KAAMoL,aAAMmJ,EAANnJ,CAAmBoJ,IAC5D,eAACI,GAAA,EAAD,CACA7P,KAAMyP,EACNlU,EAAG,SAACmU,GAAD,OAAgBA,EAAMhH,SACzBlN,EAAG,SAACkU,GAAD,OAAgBA,EAAM/G,SACzBkE,OAAO,UACP2B,YAAaA,IACTE,IAEPe,EAAKvT,KAAI,SAAAwT,GAAK,OAAInG,EAAe,CAACmG,EAAMzU,KAAMyU,EAAM3O,MACjD,eAAC+O,GAAA,EAAD,CACA5M,KAAMwM,EAAMhH,QACZtF,IAAKsM,EAAM/G,QACXiE,KAAK,UACLC,OAAO,UACPR,KAAMgD,EACNb,YAAazH,KAAKqI,IAAIZ,EAAc,EAAG,KACnCG,SAlBJjN,UAyBxB,eAACqH,EAAD,QAUGgH,GALE,SAACxF,GACd,IAAMjL,EAAY0E,GAAeW,IACjC,OAAOrF,GAAa,eAAC,GAAD,2BAAkBiL,GAAlB,IAAyBjL,UAAWA,M,oBCtHtD0Q,GAAc,SAAC,GAQd,IAPHhQ,EAOE,EAPFA,KAOE,IANF0H,iBAME,MANU,KAMV,MALFC,0BAKE,SAJFtL,EAIE,EAJFA,MACAC,EAGE,EAHFA,OACAgD,EAEE,EAFFA,UACAyB,EACE,EADFA,KAEMkP,EAAWpI,IAAMgH,SAAQ,iBApBf,KAqBZ9H,KAAKC,IAAI3K,EAAOC,KAChB,CAACD,EAAOC,IAEN4T,EAAWrI,IAAMgH,SAAQ,iBAvBf,IAwBZ9H,KAAKC,IAAI3K,EAAOC,KAChB,CAACD,EAAOC,IAEN6T,EAAYlF,GAAYjL,EAAK0F,OAAQ3E,GACtC7E,KAAI,mCAAEwI,EAAF,KAAKzG,EAAL,wBAAC,eACCqB,EAAUoF,IACVzG,MAGL6N,EAASjE,IAAMgH,SAAQ,kBAAMuB,aAAkB,CACjDjJ,MAAO,CAAC8I,EAAU5T,EAAQ4T,GAC1B/D,OAAO,EACPF,OAAQmE,EAAUjU,KAAI,SAAAkK,GAAI,OAAIA,EAAKnL,QACnCoO,QAAS,QACT,CAAC8G,EAAWF,EAAU5T,IACpB8P,EAAStE,IAAMgH,SAAQ,kBAAM9C,aAAoB,CACnDC,OAAQ,CAAC,EAAGoD,aAAIzR,EAAgBqC,EAAKyF,QAAQjK,KAC7C2L,MAAO,CAAC7K,EAAS4T,EAAUA,GAC3BhE,OAAO,MACP,CAAClM,EAAM1D,EAAQ4T,IAEbjK,EAAQkK,EAAUjU,KAAI,SAAAkK,GAAI,kCACzBA,GADyB,IAE5BsC,QAASoD,EAAO1F,EAAKnL,MACrB0N,QAASwD,EAAO/F,EAAK5K,QAGzB,EACIiM,GAAUxB,EAAO,CAAC,QAASyB,EAAWC,GADnCoD,EAAP,EAAOA,6BAA8BhC,EAArC,EAAqCA,QAGrC,OACI,uCACI,sBAAK1M,MAAOA,EAAOC,OAAQA,EAAS4T,EAApC,SACKjK,EAAM/J,KAAI,SAAAkK,GAEP,MAA6BuD,sBAAU,iBAAO,CAC1C4C,MAAOnG,EAAKuC,YADhB,mBAAS4D,EAAT,KAASA,MAQT,OAJA1C,EAJA,MAIQ,CACJ0C,MAAOnG,EAAKuC,UAGToC,EAA6B,CAAC3E,EAAKnL,MACtC,eAAC,YAASsI,KAAV,CACI/H,EAAG+Q,EAAMpC,IAAG,SAAA5O,GAAC,OAAIA,KACjBe,OAAQiQ,EAAMpC,IAAG,SAAA5O,GAAC,OAAIe,EAASf,KAC/BA,EAAG6K,EAAKsC,QACRrM,MAAOyP,EAAOuE,YACdzD,KAAK,kBAKrB,eAAC7D,EAAD,QAYGuH,GAPC,SAAC/F,GACb,IAAMxJ,EAAOiD,GAAelD,GACtBxB,EAAY0E,GAAeW,IACjC,OAAO5D,GAAQzB,GACb,eAAC,GAAD,2BAAiBiL,GAAjB,IAAwBxJ,KAAMA,EAAMzB,UAAWA,M,wRCjC/CiR,GAAa,SAAC,GAA2C,IAA1CC,EAAyC,EAAzCA,QAAS/M,EAAgC,EAAhCA,SAAgC,IAAtBgN,kBAAsB,SAQ1D,OAPA5I,IAAMtF,WAAU,WACZmO,OAAOC,SAASC,KAAO,UACvB,IAAMC,EAAe,kBAAML,EAAiC,YAAzBE,OAAOC,SAASC,OAEnD,OADAF,OAAO5N,iBAAiB,aAAc+N,GAC/B,kBAAMH,OAAO3N,oBAAoB,aAAc8N,MACvD,IAGC,eAACC,GAAA,EAAD,CACItJ,UAAU,eACVuJ,MAAM,EACNC,QAAS,kBAAMN,OAAOO,QAAQC,QAC9BT,WAAYA,EACZU,aAAW,EALf,SAOK1N,KAKP2N,GAAkB,SAACjQ,EAAoBJ,EAAcsQ,EAAcC,EAAYC,GACjF,OAASpQ,EAAS/F,kBAAoB+F,EAAS/F,mBAAqBN,EAAgBe,QAIhF0V,EAAa,MACbD,EAAWE,cAAgB,OAC3BH,EAAaG,cALbD,EAAa,OACbF,EAAaG,gBAKM,SAAlBrQ,EAASlG,KAAkB,GAA3B,YAAqC8F,EAArC,OAGI0Q,GAAkB,SAAC,GAE4B,IAF3BC,EAE0B,EAF1BA,KAAMlB,EAEoB,EAFpBA,QAASmB,EAEW,EAFXA,MAAOC,EAEI,EAFJA,SACvBP,EAC2B,EAD3BA,aAAcC,EACa,EADbA,WAAYC,EACC,EADDA,WAAYM,EACX,EADWA,eACtC1Q,EAA2B,EAA3BA,SAAUJ,EAAiB,EAAjBA,KAAMkF,EAAW,EAAXA,MACtC6L,EAAQC,eACRtB,EAAauB,aAAcF,EAAMG,YAAYC,KAAK,OAClDC,EAAYf,GAAgBjQ,EAAUJ,EAAMsQ,EAAcC,EAAYC,GACtEa,EAAmBhW,EAAY,GACrC,EAA8CyL,IAAMC,SAASsK,GAA7D,mBAAOC,EAAP,KAAwBC,EAAxB,KACA,EAAsCzK,IAAMC,SAAS,CACjDzL,MA3DkB,IA4DlBC,OA3DmB,MAyDvB,mBAAOiW,EAAP,KAAoBC,EAApB,KAIA,EAAkC3K,IAAMC,SAAS,CAC7CzL,MAAO+V,EAAiB/V,MACxBC,OAAQ8V,EAAiB9V,SAF7B,mBAAOmW,EAAP,KAAkBC,EAAlB,KAIA,EAA4B7K,IAAMC,SAAS,OAA3C,mBAAO6K,EAAP,KAAeC,EAAf,KACA,EAA8B/K,IAAMC,SAAiB,MAArD,mBAAO+K,EAAP,KAAgBC,EAAhB,KAEMC,EAAc,SAACC,GACjB,OAAOA,EAAOC,UAAU,YAAa,IAWnCC,EAAiB,SAAC,GAAkB,IAAjBJ,EAAgB,EAAhBA,WAsBfK,EAAa,SAACC,GAChBV,EAAaU,GACbZ,EAtGiB,SAAC,GAAqB,IAApBnW,EAAmB,EAAnBA,MACrBgX,EADwC,EAAZ/W,OACXD,EACjBiX,EAAKvM,KAAKC,IALM,IAKFqM,EAJG,KAKjBE,EAAIxM,KAAKC,IAAIsM,EAAKD,EANF,KAQtB,MAAO,CAAChX,MAAOkX,EAAGjX,OADRyK,KAAKC,IAAIuM,EAAIF,IAkGAG,CAAqBJ,KAiClChK,EAAWrC,KAAKmF,MAAMqG,EAAYlW,MAAQ,IAEhD,OACI,uCACI,sBAAKmL,UAAU,eAAf,4BACA,gBAACiM,GAAA,EAAD,CAAejM,UAAU,iBAAzB,UACI,uBAAK7I,GAAG,oBAAR,UACI,sBAAKA,GAAG,UAAUgF,MAAK,2BAAM4O,GAAN,IAAmBnJ,aAA1C,SACI,uBAAK5B,UAAU,aAAf,UACI,uBAAKA,UAAU,aAAf,UACI,sBAAKA,UAAU,QAAf,SAAwB2K,IACxB,sBAAK3K,UAAU,WAAf,sDAGCkK,KAEHG,GAAkBP,GACpB,sBAAK9J,UAAU,SAAf,SACK8J,GAAc,SAGjBO,GAAkBN,GACpB,sBAAK/J,UAAU,SAAf,SACK+J,SAKb,sBAAK/J,UAAU,4BAAf,wBAIJ,sBAAKA,UAAU,iBAAf,SACI,uBAAKA,UAAU,cAAf,UACI,gBAACkM,GAAA,EAAD,WACI,eAACC,GAAA,EAAD,CAAYC,QAAQ,WAAWC,QAAQ,cAAvC,kBACA,gBAACC,GAAA,EAAD,CAAcnV,GAAG,cACHoV,SAnEX,SAACtR,GACxB,IAAMxH,EAAOwH,EAAMG,OAAO7D,MAC1B,GAAa,WAAT9D,EACAqX,EAAmB,MACnBzP,SACKmR,uBAAuB,uBAAuB,GAC9CA,uBAAuB,iBAAiB,GACxCC,SAAS,EAAG,UACd,CACH,IAAMC,EAAI3X,EAAetB,GACzBqX,EAAmB4B,GACnBf,EAAWe,KAyDmBnV,MAAOsT,EAAkBA,EAAgBpX,KAAO,SAF9D,UAGI,2BAAU0W,MAAM,UAAhB,SACKvV,EAAYF,KAAI,SAACgY,GAAD,OACb,kCAAsBA,EAAEjZ,MAAXiZ,EAAEjZ,WAGvB,mDAGR,eAACkZ,GAAA,EAAD,CAAWC,KAAG,EAAC5M,UAAU,oCAAzB,SACK,CAAC,QAAS,UAAUtL,KAAI,SAACgY,GAAD,OACrB,eAACR,GAAA,EAAD,CAAqBlM,UAAU,+BAA/B,SACI,eAAC6M,GAAA,EAAD,CAAWC,WAAYJ,EACZN,QAAQ,WACRG,SAAU,SAACtR,GAAD,OAnE/B2Q,EAoEsC,2BAAIX,GAAL,kBAAiByB,EAAIzR,EAAMG,OAAO7D,QAnEzFuT,EAAmB,WACnBa,EAAWC,GAFM,IAACA,GAqEqBrU,MAAO0T,EAAUyB,MALdA,QAS1B,eAACC,GAAA,EAAD,CAAWC,KAAG,EAAC5M,UAAU,MAAzB,SACI,gBAACkM,GAAA,EAAD,CAAalM,UAAU,eAAvB,UACI,eAACmM,GAAA,EAAD,CAAYC,QAAQ,WAAWC,QAAQ,QAAvC,0BACA,gBAACC,GAAA,EAAD,CAAcnV,GAAG,QACHI,MAAO4S,GAAgB,IACvBoC,SAzEpB,SAACtR,GACnB,IAAM1D,EAAQ0D,EAAMG,OAAO7D,MAC3B6S,EAAmB,MAAV7S,EAAgB,KAAOA,IAqER,UAGI,yBAAQA,MAAM,MACbkH,EAAM/J,KAAI,gBAAEjB,EAAF,EAAEA,KAAF,OACP,kCAAoBA,GAAPA,cAK7B,gBAACkZ,GAAA,EAAD,CAAWC,KAAG,EAAC5M,UAAU,iBAAzB,UACI,gBAACkM,GAAA,EAAD,CAAalM,UAAU,eAAvB,UACI,eAACmM,GAAA,EAAD,CAAYC,QAAQ,WAAWC,QAAQ,SAAvC,oBACA,gBAACC,GAAA,EAAD,CAAcnV,GAAG,SACHI,MAAO4T,EACPoB,SAjFnB,SAACtR,GACpB,IAAM1D,EAAQ0D,EAAMG,OAAO7D,MAC3B6T,EAAU7T,IA6Ec,UAII,0CACA,gDAGR,gBAAC2U,GAAA,EAAD,CAAalM,UAAU,eAAvB,UACI,eAACmM,GAAA,EAAD,CAAYC,QAAQ,WAAWC,QAAQ,aAAvC,kBAGA,gBAACC,GAAA,EAAD,CAAcnV,GAAG,aAAaI,MAAM,aAApC,UACI,4CACA,oDAIZ,eAAC2U,GAAA,EAAD,CAAalM,UAAU,eAAvB,SACI,eAAC+M,GAAA,EAAD,CACIC,QACI,eAACC,GAAA,EAAD,CACI3G,MAAM,YAGd6D,MAAM,0BAM1B,gBAAC+C,GAAA,EAAD,CAAelN,UAAU,iBAAzB,UACI,eAACmN,GAAA,EAAD,CAAQrS,QAAS,kBAAMoO,OAAOO,QAAQC,QAAtC,mBACA,eAACyD,GAAA,EAAD,CAAQrS,QAnKH,WACb,IAAMsS,EAAU/R,SACXgS,eAAe,WACfb,uBAAuB,cAAc,IAZ5B,WAClB,OAAQrB,GACJ,IAAK,MAAO,OAAOmC,cAAQ,SAAA3Y,GAAC,OAAIA,EAAE4Y,KAAKhC,KAAciC,MACrD,IAAK,MAAO,OAAOA,KACnB,QAAS,MAAMtO,MAAM,qBAAuBiM,KAS5CsC,GAAgBL,EAAI,CAChBM,YAAazC,EAAUpW,MACvB8Y,aAAc1C,EAAUnW,OAGxB8Y,QAAS,EACTzR,MAAO,KAMRoR,MAAK,SAACM,GACLvC,EAAWuC,OAkJP,6BAMVC,EAAiB,SAAC,GAA2B,IAA1BzC,EAAyB,EAAzBA,QAASC,EAAgB,EAAhBA,WACxByC,EAAM7E,OAAOC,SAAS6E,KAc5B,OACI,uCACI,sBAAKhO,UAAU,eAAf,4BACA,gBAACiM,GAAA,EAAD,CAAejM,UAAU,iBAAzB,UACI,sBAAKA,UAAU,kBAAf,SACI,oBAAGiO,SAAUtD,EAAWqD,KAAM3C,EAA9B,SACI,sBAAK6C,IAAI,YAAYC,IAAK9C,QAGlC,sBAAKrL,UAAU,iBAAf,SACI,sBAAKA,UAAU,mBAAf,SACI,sBAAKA,UAAU,kBAAf,SACI,gBAACoO,GAAA,EAAD,CACIL,IAAKA,EACLM,MAAOhD,EAFX,UAII,eAACiD,GAAA,EAAD,CAAe5J,OAAK,IACpB,sBAAKvI,MAAO,CAACmK,MAAO,WAApB,4CAQpB,gBAAC4G,GAAA,EAAD,CAAelN,UAAU,iBAAzB,UACI,eAACmN,GAAA,EAAD,CAAQrS,QAAS,kBAAMwQ,EAAW,OAAlC,kBACA,eAAC6B,GAAA,EAAD,CAAQrS,QAAS,kBAAMoO,OAAOO,QAAQC,QAAtC,mBACA,eAACyD,GAAA,EAAD,CAAQa,KAAM3C,EAAS4C,SAAUtD,EAAjC,6BAKhB,OACI,eAAC,GAAD,CAAY3B,QAASA,EAASC,WAAYA,EAA1C,SACKoC,EACK,eAACyC,EAAD,CAAgBzC,QAASA,EAASC,WAAYA,IAC9C,eAACI,EAAD,CAAgBJ,WAAYA,OAMjCiD,GAAc,SAACxL,GACxB,IAAMpJ,EAAW6C,GAAe9C,GAC1BH,EAAOiD,GAAelD,GACtBmF,EAAQlI,OAAOC,OAAOgG,GAAeW,KAC3C,OAAO,eAAC,GAAD,2BAAqB4F,GAArB,IAA4BpJ,SAAUA,EAAUJ,KAAMA,EAAMkF,MAAOA,MAGjE+P,GAAc,SAAC,GAAqD,IAApDxF,EAAmD,EAAnDA,QAASa,EAA0C,EAA1CA,aAAcC,EAA4B,EAA5BA,WAAYC,EAAgB,EAAhBA,WACtDgE,EAAM7E,OAAOC,SAAS6E,KACtBrU,EAAW6C,GAAe9C,GAC1BH,EAAOiD,GAAelD,GACtBqR,EAAYf,GAAgBjQ,EAAUJ,EAAMsQ,EAAcC,EAAYC,GAC5E,OACI,eAAC,GAAD,CAAYf,QAASA,EAArB,SACI,uCACI,sBAAKhJ,UAAU,gBAAf,SACI,sBAAKA,UAAU,eAAf,qBAEJ,gBAACiM,GAAA,EAAD,CAAejM,UAAU,iBAAzB,UACI,uBAAKA,UAAU,cAAf,UACI,eAACyO,GAAA,EAAD,CACIV,IAAKA,EACLW,MAAO/D,EAFX,SAII,eAACgE,GAAA,EAAD,CAAcjK,OAAK,MAEvB,eAACkK,GAAA,EAAD,CACIb,IAAKA,EACLc,MAAOlE,EAFX,SAII,eAACmE,GAAA,EAAD,CAAapK,OAAK,MAEtB,eAACqK,GAAA,EAAD,CACIhB,IAAKA,EACLc,MAAOlE,EAFX,SAII,eAACqE,GAAA,EAAD,CAAYtK,OAAK,MAErB,eAACuK,GAAA,EAAD,CAAqBlB,IAAKA,EAA1B,SACI,eAACmB,GAAA,EAAD,CAAcxK,OAAK,SAG3B,uBAAKvI,MAAO,CAACgT,QAAS,QAAtB,UACI,eAACtC,GAAA,EAAD,CAAWtV,MAAOwW,IAClB,eAAC,mBAAD,CAAiBqB,OAAQ,aAAUC,KAAMtB,EAAzC,SACI,eAACuB,GAAA,EAAD,CAAY,aAAW,OACXtP,UAAU,WACV6O,MAAM,oBAFlB,SAGI,eAAC,KAAD,oB,oBC5Y1BU,GAAeC,aAAOC,KAAPD,CAAe,CAChClJ,MAAO,UACPxR,OAAQ,EACR,qBAAsB,CAClB4a,OAAQ,QAEZ,qBAAsB,CAClB5a,OAAQ,GACRD,MAAO,GACP8a,gBAAiB,OACjBD,OAAQ,yBACR,qDAAsD,CAClDE,UAAW,WAEf,WAAY,CACRT,QAAS,SAGjB,0BAA2B,CACvBU,WAAY,IACZjO,SAAU,GACVkO,WAAY,QACZjO,QAAS,EACThN,MAAO,GACPC,OAAQ,GACRib,aAAc,gBACdJ,gBAAiB,UACjBK,gBAAiB,cACjB3T,UAAW,gDACX,WAAY,CAAE8S,QAAS,QACvB,6BAA8B,CAC1B9S,UAAW,iDAEf,QAAS,CACLA,UAAW,kBAGnB,wCAAyC,CACrC8S,QAAS,UAqCFc,GAjCI,WACf,IAAM1W,EAAOiD,GAAelD,GACtBK,EAAW6C,GAAe9C,GAC1B9B,EAAQ4E,GAAea,IACvB6S,EAAW5T,KAEjB,OAAO3C,GAAY/B,GAAS2B,GACxB,eAAC4W,GAAA,EAAD,CAAKC,GAAI,CACLC,KAAM,OADV,SAGI,eAACd,GAAD,CACIe,aAAcjX,YAAKzB,GACnB4H,IAAK5H,EAAM,GACXgQ,IAAKvO,YAAKzB,GACV2Y,KAAM,EACNC,SAA4B,SAAlB7W,EAASlG,KACnBgd,kBAAkB,KAClBlE,SAAU,SAACtR,EAAOjH,GACVuF,IAASvF,GACTkc,EAAS/W,EAAQnF,KAGzBoc,GAAI,CACAM,WAAY,OACZ,yBAA0B,CACtB9U,IAAK,c,oBC5Cd+U,GAzBQ,WACnB,IAAMhX,EAAW6C,GAAe9C,GAC1BwW,EAAW5T,KAOjB,OACI,sBAAK0D,UAAU,YAAf,SACI,eAAC4Q,GAAA,EAAD,CAAmB/L,KAAK,QACLtN,MAAOoC,EAASlG,KAChBod,WAAS,EACTtE,SATJ,SAACtR,EAAOxH,GAC3Byc,EAASzW,EAAYhG,KAKjB,SAIKD,EAAWkB,KAAI,SAACoc,GAAD,OACZ,eAACC,GAAA,EAAD,CAA4BxZ,MAAOuZ,EAAGrd,KAAtC,SACK,eAACqd,EAAGpd,KAAJ,KADcod,EAAGrd,c,UC8E3Bud,GA9EE,WACb,IAAMrX,EAAW6C,GAAe9C,GAC1BgB,EAAW8B,GAAeQ,IAC1BiU,EAAkB/M,GAAiBxJ,GACnCwW,EAAgB1U,GAAezD,GAC/BpB,EAAQ6E,GAAe1D,GACvBoX,EAAW5T,KAEX6U,EAbU,SAACrd,GACjB,IAAMsd,EAAKzS,cAAQ,SAAA3J,GAAC,OAAIA,EAAEI,QAAOtB,GACjC,OAAOyC,OAAOmC,KAAK0Y,GAAI1c,KAAI,SAAAwI,GAAC,MAAK,CAAEzJ,KAAMyJ,EAAGpJ,OAAQsd,EAAGlU,OAW5BmU,CAAYH,GAEjCI,EAAc,SAACC,GACjB,IAAM7E,EAAI,CACNxS,IAAK3D,OAAOmC,KAAK6Y,GAAU,GAC3Bha,MAAOhB,OAAOC,OAAO+a,GAAU,IAEnC,OAAOrB,EAASjW,GAAWyS,KAGzB8E,EAAc,SAAC,GAA+B,IAA9BzT,EAA6B,EAA7BA,MAClB,OACI,gBAACmO,GAAA,EAAD,CAAalM,UAAU,eACVwQ,UAAW7W,EAAS7F,OAAOiK,GADxC,UAEI,eAACoO,GAAA,EAAD,CAAYC,QAAQ,WAAWC,QAAO,gBAAWtO,GAAjD,SACKpE,EAAS7F,OAAOiK,IAAhB,UAA6BA,EAAM0T,cAAnC,WAEL,eAACnF,GAAA,EAAD,CAAcnV,GAAE,gBAAW4G,GAASxG,MAAOmD,EAASqD,GAAO5G,GAC7CoV,SAAU,SAACtR,GAAD,OACNqW,EAAY,eAAEvT,EAAQ9C,EAAMG,OAAO7D,SAFrD,SAIK4Z,EAAmBzc,KAAI,SAAA+N,GAAC,OACrB,2BAAU0H,MAAO1H,EAAEhP,KAAnB,SACKgP,EAAE3O,OAAOY,KAAI,SAAAM,GAAC,OACX,yBAAmBuC,MAAOvC,EAAEmC,GAA5B,SAAiCnC,EAAEvB,MAAtBuB,EAAEmC,QAFOsL,EAAEhP,eAWpD,OAAOwd,GAAmBtZ,EAAMD,OAAOmF,OAAS,GAC5C,uBAAKmD,UAAU,WAAf,UACI,eAAC,GAAD,IACA,eAAC0R,GAAA,EAAD,CACIva,GAAG,OACH6I,UAAU,eACVkC,QAASvK,EAAMD,OACfH,MAAOmD,EAASZ,KAAK3C,GACrBwa,eAAgB,SAACC,GAAD,OAAYja,EAAMF,KAAKma,GAAQne,MAC/Coe,YAAa,SAACC,GAAD,OACT,eAACjF,GAAA,EAAD,aAAWT,QAAQ,WAAWjC,MAAM,QAAW2H,OAEvD,gBAAC5F,GAAA,EAAD,CAAalM,UAAU,eAAvB,UACI,eAACmM,GAAA,EAAD,CAAYC,QAAQ,WAAWC,QAAQ,aAAvC,wBACA,gBAACC,GAAA,EAAD,CAAcnV,GAAG,aAAaI,MAAOmD,EAASX,QAAQ5C,GACxCoV,SAAU,SAACtR,GAAD,OACNqW,EAAY,CAACvX,QAASkB,EAAMG,OAAO7D,SAFrD,UAII,4BAAU4S,MAAM,OAAhB,UACI,yBAAQ5S,MAAM,QAAd,mBACA,6CACA,yBAAQiZ,UAAU,EAAlB,sBAEJ,4BAAUrG,MAAM,eAAhB,UACI,0CACA,2CACA,mDAIZ,eAACqH,EAAD,CAAazT,MAAM,MACnB,eAACyT,EAAD,CAAazT,MAAM,MACnB,eAACyT,EAAD,CAAazT,MAAM,U,8BC1ElBgU,GAGT,WAAYC,GAA8B,IAAD,iCAFjCA,YAEiC,OAIjCC,kBAAoB,WACxB,IAAMrY,EAAYC,eAClB,OAAO,EAAKmY,OAAOE,kBAAkBtY,GAChClF,KAAI,SAAAyd,GAAC,MAAIC,iBAAuBD,MAPA,KAUjCE,aAAe,SAACC,GACpBC,KAAM9S,IAAI6S,EAAK5d,KAAI,SAAAqZ,GAAG,OAAIwE,KAAMC,IAAIzE,OAC/BR,KAAKgF,KAAME,QAAO,sCAAIC,EAAJ,yBAAIA,EAAJ,uBACfA,EAAUhe,KAAI,SAAAoP,GAAC,OAAI,EAAKkO,OAAOW,aAAa7O,EAAEtL,cAbjB,KAiBzCoa,YAAc,kBAAM,EAAKP,aAAa,EAAKJ,sBAhBvCY,KAAKb,OAASA,GCSPc,GA1BK,WAChB,IAAM5C,EAAW5T,KAsBjB,OApBA+D,IAAMtF,WAAU,WAaS,IAAIgX,GAAqB,CAC1CG,kBAbsB,SAACJ,GACvB,MAAO,CDJkB,cAK1B,cAIA,oBCQCa,aANiB,SAACI,GAClB7C,EAAS7X,EAAQ0a,OAOPH,gBACf,CAAC1C,IAEG,M,oBCsBI8C,GAvCH,WACR,IAAMtY,EAAW8B,GAAeQ,IAC1BiW,EAAazW,GAAelD,GAC5BK,EAAW6C,GAAe9C,GAC1BwW,EAAW5T,KAEjB,EAA0B4W,aAAe,CACrCnf,EAAGof,KACHnf,EAAGmf,KACHlf,EAAGkf,KACHrZ,KAAMqZ,KACNpZ,QAASoZ,KACTjJ,KAAMkJ,aAAgB,CAAC,OAAQ,SAAU,MAAO,QAChD7Z,KAAM8Z,OAPV,mBAAOC,EAAP,KAAcC,EAAd,KA8BA,OApBAlT,IAAMtF,WAAU,WACZ,IAAQhH,EAAiCuf,EAAjCvf,EAAGC,EAA8Bsf,EAA9Btf,EAAGC,EAA2Bqf,EAA3Brf,EAAG8F,EAAwBuZ,EAAxBvZ,QAASmQ,EAAeoJ,EAAfpJ,KAAM3Q,EAAS+Z,EAAT/Z,KAC1Bia,EAAkBva,cAAO,SAAAxC,GAAC,QAAMA,IAAG,CAAC1C,IAAGC,IAAGC,IAAG8F,YACnDmW,EAAS/V,GAAYqZ,IACrBtD,EAASzW,EAAYyQ,IACrBgG,EAAS/W,EAAQI,MAClB,CAAC2W,IAEJ7P,IAAMtF,WAAU,WACZ,GAAImJ,GAAiBxJ,GAAW,CAC5B,IAAM+Y,EAAS,yBACXvJ,KAAMvQ,EAAWA,EAASlG,KAAO,MAC9BiB,aAAI,SAAAM,GAAC,OAAIA,EAAIA,EAAEmC,GAAK,OAAMuD,IAFlB,IAGXnB,KAAM0Z,IAEJnB,EAAS7Y,cAAO,SAAAtE,GAAC,QAAMA,IAAG8e,GAChCF,EAASzB,EAAQ,gBAEtB,CAAC5B,EAAUoD,EAAOC,EAAU7Y,EAAUuY,EAAYtZ,IAE9C,MCCX+Z,cAAiBC,GACjBC,EAAQ,KAER,IAAMC,GAAc,SAAC,GAAD,IAAEhf,EAAF,EAAEA,MAAOC,EAAT,EAASA,OAAT,OAChB,sBAAKkL,UAAU,eAAe7D,MAAO,CAACtH,QAAOC,UAA7C,SACI,eAACgf,GAAA,EAAD,CAAkB1H,QAAQ,gBACRvH,KAAMtF,KAAKC,IAAID,KAAKmF,MAAM7P,EAAQ,GAAI,SAI1Dkf,GAAW,SAAC,GAGwB,IAHvBvb,EAGsB,EAHtBA,KAAMwb,EAGgB,EAHhBA,QAASra,EAGO,EAHPA,SACZsa,EAEmB,EAFnBA,WAEmB,IAFPnK,kBAEO,MAFI,KAEJ,MAFUC,kBAEV,MAFqB,KAErB,MADnB5J,0BACmB,SADSD,EACT,EADSA,UACzBlM,GAAgB,EAAnBD,EAAmB,EAAhBC,GACfkgB,GAD+B,EAAbC,QACP,SAACtf,EAAeC,GAC7B,IAAK0D,EACD,OAAO,KACX,OAAQmB,EAASlG,MACb,IAAK,SAAU,OAAO,eAAC,GAAD,CAAY+E,KAAMA,EACN0H,UAAWA,EACXC,mBAAoBA,EACpBtL,MAAOA,EACPC,OAAQA,IAC1C,IAAK,OAAQ,OAAO,eAAC,GAAD,CAAU0D,KAAMA,EACN0H,UAAWA,EACXC,mBAAoBA,EACpBtL,MAAOA,EACPC,OAAQA,IACtC,IAAK,MAAO,OAAO,eAAC,GAAD,CAAS0D,KAAMA,EACN0H,UAAWA,EACXC,mBAAoBA,EACpBtL,MAAOA,EACPC,OAAQA,IACpC,QAAS,OAAO,eAAC,GAAD,CAAS0D,KAAMA,EACN0H,UAAWA,EACXC,mBAAoBA,EACpBtL,MAAOA,EACPC,OAAQA,EACRsf,SAAUpgB,OAG3C,OACI,eAACqgB,GAAA,EAAD,CAAYC,aAAc,GAAItU,UAAU,KAAxC,SACK,YAAwB,IAArBnL,EAAoB,EAApBA,MAAOC,EAAa,EAAbA,OACD8M,EAAWrC,KAAKC,IAAID,KAAKmF,MAAM7P,EAAQ,IAAK,IAClD,OAAQA,EAAQC,EAAU,GACtB,uBAAKkL,UAAU,OAAO7D,MAAO,CAACtH,QAAOC,SAAQ8M,YAA7C,UACKoS,GACD,eAAC,GAAD,CAAanf,MAAOA,EAAOC,OAAQA,IAClCof,EAASrf,EAAOC,GAChBmf,IAAeta,EAASpF,gBACrB,uCACI,sBAAKyL,UAAU,SAAf,SACK8J,GAAc,SAEnB,sBAAK9J,UAAU,SAAS7D,MAAO,CAACtH,MAAOC,GAAvC,SACKiV,cAW/BwK,GAAe,SAAC,GAAiC,IAAhClF,EAA+B,EAA/BA,KAAM3b,EAAyB,EAAzBA,KAAyB,IAAnBuI,gBAAmB,MAAV,KAAU,EAClD,EAAwBoE,IAAMC,UAAS,GAAvC,mBAAOiJ,EAAP,KAAaP,EAAb,KACA,OACI,uCACI,gBAACwL,GAAA,EAAD,CAAUC,QAAM,EAAC3Z,QAAS,kBAAMkO,GAASO,IAAzC,UACI,eAACmL,GAAA,EAAD,CAAc1U,UAAU,iBAAxB,SAA0CtM,IAC1C,eAACihB,GAAA,EAAD,CAAcC,QAASvF,IACtBpT,IAAasN,EAAO,eAAC,KAAD,IAAiB,eAAC,KAAD,QAEzCtN,GACG,eAAC4Y,GAAA,EAAD,CAAUC,GAAIvL,EAAMwL,QAAQ,OAAOC,eAAa,EAAChV,UAAU,cAA3D,SACK/D,QAYfgZ,GAAgB,SAAC,GAA8C,IAAD,EAA5Ctb,EAA4C,EAA5CA,SAAUe,EAAkC,EAAlCA,SACxBwa,EAAkB1K,aAAc,gCAWhCV,EAToB,WACtB,OAAQnQ,EAAS/F,kBACb,KAAKN,EAAgBO,IAAK,OAAO6G,EAAS3G,EAAEN,KAC5C,KAAKH,EAAgBe,QAAS,OAAOqG,EAASX,QAAQtG,KACtD,KAAKH,EAAgBa,KAAM,MAAO,OAClC,QAAS,OAAO,MAILghB,GACbpL,EAAU,UAAGrP,EAAS1G,SAAZ,aAAG,EAAYP,KAEzB6W,EAAQjK,IAAMgH,SAChB,kBACI+N,aAAY,CACRC,QAAS,CACLC,KAAMJ,EAAkB,OAAS,QACjCN,QAAS,CACLW,KAAML,EAAkB,UAAY,YAG5CzK,YAAa,CACTjU,OAAQ,CACJf,GAAI,EACJ+f,GAAI,IACJC,GAAI,IACJC,GAAI,IACJC,GAAI,WAIpB,CAACT,IAGCU,EAAO,SAAC,GAAgE,IAA/D3B,EAA8D,EAA9DA,WAA8D,IAAlD/T,iBAAkD,MAAtC,KAAsC,MAAhCC,0BAAgC,SACnE3H,EAAOgE,GAAewB,IAC5B,OAAOtD,EAAS1G,GACZ,eAAC,GAAD,CAAUwE,KAAMA,EACNwb,SAAUxb,EACVmB,SAAUA,EACVsa,WAAYA,EACZ9T,mBAAoBA,EACpBD,UAAWA,EACXnM,EAAG2G,EAAS3G,EACZC,EAAG0G,EAAS1G,EACZ8V,WAAYA,EACZC,WAAYA,EACZoK,QAASzZ,EAASmK,QAK9BgR,EAAW,WACb,IAAMX,EAAkB1K,aAAc,gCACtC,EAAoCnK,IAAMC,UAAS,GAAnD,mBAAOwV,EAAP,KAAmBC,EAAnB,KACA,EAAoC1V,IAAMC,UAAS,GAAnD,mBAAO0V,EAAP,KAAmBC,EAAnB,KACA,EAAkC5V,IAAMC,UAAS,GAAjD,mBAAO4V,EAAP,KAAkBC,EAAlB,KACA,EAAkC9V,IAAMC,SAAS,MAAjD,mBAAOJ,EAAP,KAAkBkW,EAAlB,KAEMC,EACF,uBAAKrW,UAAU,YAAf,UACI,eAACsW,GAAA,EAAD,IACA,gBAACC,GAAA,EAAD,WACI,oBAAGvI,KAAK,IAAR,SACI,eAAC,GAAD,CAAcqB,KAAK,eAAe3b,KAAM,eAAC,KAAD,QAE5C,eAAC,GAAD,CAAc2b,KAAK,WAAW3b,KAAM,eAAC,KAAD,MACpC,eAAC,GAAD,CAAc2b,KAAK,UAAU3b,KAAM,eAAC,KAAD,IAAnC,SACI,gBAAC6iB,GAAA,EAAD,WACI,eAAC/B,GAAA,EAAD,CAAUC,QAAM,EAAhB,SACI,eAACE,GAAA,EAAD,qCAIJ,eAACH,GAAA,EAAD,CAAUC,QAAM,EAAhB,SACI,eAACE,GAAA,EAAD,sCAOhB,eAAC2B,GAAA,EAAD,OAGR,OACI,uCACI,iCACI,eAACE,GAAA,EAAD,CAAQC,MAAI,EAAZ,SACI,eAACC,GAAA,EAAD,CACItK,QAAQ,YACR7C,KAAMuM,EACNtM,QAAS,kBAAMuM,GAAc,IAC7BY,WAAY,CACRhN,aAAa,GALrB,SAQK0M,MAGT,eAACG,GAAA,EAAD,CAAQI,QAAM,EAAd,SACI,eAACF,GAAA,EAAD,CACItK,QAAQ,YACR7C,MAAI,EAFR,SAIK8M,SAIb,eAACQ,GAAA,EAAD,CAAQ7W,UAAU,UACV8W,SAAS,SACTC,UAAW7B,EAAkB,EAAI,EAFzC,SAGI,gBAAC8B,GAAA,EAAD,CAAS5K,QAAQ,QAAjB,UACI,eAACkD,GAAA,EAAD,CAAY2H,KAAK,QACL7G,GAAI,CACA8G,YAAa5M,EAAM6M,QAAQ,GAC3BhI,QAAS,CAAE1Z,GAAI,cAAekgB,GAAI,SAEtC7a,QAAS,kBAAMib,GAAeD,IAC9BxP,MAAM,UACN,aAAW,OAPvB,SAQI,eAAC,KAAD,MAEJ,eAAC8Q,GAAA,EAAD,CACIhL,QAAQ,KACRjQ,MAAO,CAACkb,WAAY,KACpBjH,GAAI,CACAjB,QAAS,CAAC,OAAQ,UAJ1B,mCASA,sBAAKnP,UAAU,SACf,eAACsP,GAAA,EAAD,CAAYtP,UAAU,WACVlF,QAAS,kBAAMmb,GAAc,IAC7B3P,MAAM,UAFlB,SAGI,eAAC,KAAD,MAEJ,eAACgJ,GAAA,EAAD,CAAY2H,KAAK,MACLjX,UAAU,WACVlF,QAAS,kBAAMqb,GAAa,IAC5B7P,MAAM,UAHlB,SAII,eAAC,KAAD,WAIX0P,GAAc,eAAC,GAAD,CACKhN,QAASiN,EACT9L,MAAOjK,EACPkK,SAAUgM,EACVvM,aAAcnP,EAASX,QAAQtG,KAC/BqW,WAAYA,EACZC,WAAYA,EACZM,gBAAiB1Q,EAASpF,eAC1B2V,KAAM,eAAC0L,EAAD,CAAM3B,YAAY,EACZ9T,oBAAoB,EACpBD,UAAWA,MAC1CgW,GAAa,eAAC,GAAD,CACIrM,aAAcnP,EAASX,QAAQtG,KAC/BqW,WAAYA,EACZC,WAAYA,EACZf,QAASmN,QAOvC,OAFAmB,aAAe,CAAC3d,EAAUe,IAGtB,gBAAC6c,GAAA,EAAD,CAAejN,MAAOA,EAAtB,UACI,eAACkN,GAAA,EAAD,IACA,gBAACrH,GAAA,EAAD,CAAKC,GAAI,CACLqH,UAAW,aACX5iB,MAAO,OACPC,OAAQ,OACRqa,QAAS,OACTuI,cAAe,SACfC,YAAa,CAAEliB,GAAI,EAAGkgB,GAAI,UAN9B,UAQI,eAACE,EAAD,IACA,uBAAK1e,GAAG,YAAR,UACI,kCACI,sBAAK6I,UAAU,YAAf,SACI,eAAC4X,GAAA,EAAD,CAAM5X,UAAU,UAAhB,SACI,sBAAK7I,GAAG,uBAAR,SACI,eAACye,EAAD,CAAM3B,YAAY,UAI9B,uBAAKjU,UAAU,WAAf,UACI,eAACsP,GAAA,EAAD,CAAYtP,UAAU,OAAOwQ,SAA4B,SAAlB7W,EAASlG,KAAhD,SACI,eAAC,KAAD,MAEJ,eAAC,GAAD,UAGR,iCACI,eAAC,GAAD,gBAQlBokB,GAAY,CAEdC,KAAM,SAAC3O,GAAD,OAAwBM,QAAQsO,UAAU,GAAI,KAAM5O,EAAS6E,OAEnEgK,QAAS,SAAC7O,GAAD,OAAwBM,QAAQwO,aAAa,GAAI,KAAM9O,EAAS6E,QAGvEkK,GAAY,WACd,IAAMve,EAAW6C,GAAe9C,GAC1BgB,EAAW8B,GAAeQ,IAC1BiU,EAAkB/M,GAAiBxJ,GACzC,OACI,uCAEQuW,GAAmBtX,GACnB,eAAC,GAAD,CAAeA,SAAUA,EAAUe,SAAUA,IAEjD,eAAC,GAAD,IACA,eAAC,KAAD,CAAoB+O,QAASoO,GAA7B,SACI,eAAC,GAAD,UAYDM,UANM,kBACjB,eAAC,IAAD,CAAU/d,MAAOA,GAAjB,SACI,eAAC,GAAD,Q,gCCxXR,oEAAO,IAAMge,EAAS,SAACC,EAAMC,GAAP,OAAgBD,EAAKzhB,QAAO,SAACjC,EAAEsN,EAAEvC,GAEnD,OADA/K,EAAEsN,GAAKqW,EAAK5Y,GACL/K,IACT,KAEWkF,EAAe,WACxB,IAAMkU,EAAMwK,UAAUrP,OAAOC,SAAS6E,MAChCwK,EAAWzK,EAAI0K,QAAQ,KACzBrP,EAAO2E,EAAI0K,QAAQ,KACvB,IAAc,IAAVrP,IAA6B,IAAdoP,EAAiB,MAAO,IAC7B,IAAVpP,IAAaA,EAAO2E,EAAIlR,QAC5B,IAAMyW,GAAsB,IAAdkF,GAAmBpP,IAASoP,EAAW,EAAIzK,EAAI2K,UAAUtP,GACnE2E,EAAI2K,UAAUF,EAAS,EAAEpP,GACzBuP,EAAS,GAkBb,OAjBArF,EAAMsF,MAAM,KAAK7hB,SAAQ,SAAS8hB,GAC9B,GAAKA,EAAL,CAEA,IAAMC,GADND,EAAOA,EAAKD,MAAM,KAAK/V,KAAK,MACZ4V,QAAQ,KACpBve,EAAM4e,GAAI,EAAID,EAAKE,OAAO,EAAED,GAAMD,EAChC5hB,EAAM6hB,GAAI,EAAIE,mBAAmBH,EAAKE,OAAOD,EAAK,IAAM,GACxDG,EAAO/e,EAAIue,QAAQ,KACzB,IAAc,IAAVQ,EAAaN,EAAOK,mBAAmB9e,IAAQjD,MAC9C,CACD,IAAM0L,EAAKzI,EAAIue,QAAQ,IAAIQ,GACrBC,EAAQF,mBAAmB9e,EAAIwe,UAAUO,EAAO,EAAEtW,IACxDzI,EAAM8e,mBAAmB9e,EAAIwe,UAAU,EAAGO,IACrCN,EAAOze,KAAMye,EAAOze,GAAO,IAC3Bgf,EACAP,EAAOze,GAAKgf,GAASjiB,EADd0hB,EAAOze,GAAK4d,KAAK7gB,QAI9B0hB","file":"static/js/6.e47e9f0b.chunk.js","sourcesContent":["import SvgIcon from \"@mui/material/SvgIcon/SvgIcon\";\nimport BubbleChartIcon from '@mui/icons-material/BubbleChart';\nimport TimelineIcon from '@mui/icons-material/Timeline';\nimport BarChartIcon from '@mui/icons-material/BarChart';\nimport RoomIcon from '@mui/icons-material/Room';\nimport {zipObj, range} from \"ramda\";\nimport {RouteComponentProps} from \"@reach/router\";\n\nexport enum AxisLabelSource {\n    VAR,\n    COMPARE,\n    YEAR\n}\n\nexport type PlotType = {\n    name: string,\n    icon: typeof SvgIcon,\n    xAxisLabelSource?: AxisLabelSource,\n    hideAxisLabels?: boolean,\n    fields: {\n        x?: string,\n        y?: string,\n        z?: string\n    }\n};\n\nexport const PLOT_TYPES: PlotType[] = [{\n    name: 'bubble',\n    icon: BubbleChartIcon,\n    xAxisLabelSource: AxisLabelSource.VAR,\n    fields: {\n        x: 'X-Axis',\n        y: 'Y-Axis',\n        z: 'Size'\n    }\n}, {\n    name: 'line',  // aka. time series chart\n    icon: TimelineIcon,\n    xAxisLabelSource: AxisLabelSource.YEAR,\n    fields: {\n        // X-Axis is always time. Existing selection is kept, only disabled\n        y: 'Y-Axis'\n    }\n}, {\n    name: 'bar',\n    icon: BarChartIcon,\n    xAxisLabelSource: AxisLabelSource.COMPARE,\n    fields: {\n        // compare: 'Compare by',  // Secondary grouping nested under \"Compare by\"\n        y: 'Y-Axis'\n    }\n}, {\n    name: 'map',\n    icon: RoomIcon,\n    hideAxisLabels: true,\n    fields: {\n        y: 'Color'\n    }\n}];\n\nexport const PLOT_TYPES_MAP: Map<string, PlotType> =\n    zipObj(PLOT_TYPES.map(p => p.name), PLOT_TYPES);\n\nexport type ShareSize = {\n  name: string,\n  width: number,\n  height: number\n};\n\nexport const SHARE_SIZES: ShareSize[] = [{\n    name: 'Instagram Square',\n    width: 1080,\n    height: 1080\n}, {\n    name: 'Twitter',\n    width: 1024,\n    height: 512\n}, {\n    name: 'Pinterest',\n    width: 800,\n    height: 1200\n}, {\n    name: 'Tumblr',\n    width: 1280,\n    height: 1920\n}];\n\nexport const SHARE_SIZE_MAP: Map<string, ShareSize> =\n    zipObj(SHARE_SIZES.map(p => p.name), SHARE_SIZES);\n\nexport type Area = {\n    id: string\n    abbrev: string\n    name: string\n}\n\nexport const AREAS: Area[] = [{\n    id: 'us',\n    abbrev: 'us',\n    name: 'United States'\n}];\n\nexport interface IDashboardProps extends RouteComponentProps {\n    area?: string;\n    compare?: string\n}\n\nexport enum FieldType {\n    NUMERIC,\n    DOLLARS,\n    MINUTES = 2,\n    PERCENT = 3\n}\n\nexport type DataFieldCfg = {\n    id: string,\n    type?: FieldType\n};\n\nexport type DataField = {\n    id: string,\n    name: string,\n    group: string\n    type?: FieldType\n};\n\n// The processData script uses this config object,\n// so changes may not be reflected until reprocessing\nexport const FIELD_CFGS: {[id: string]: {type: FieldType, group?: string}} = {\n    'total_pop': {\n        type: FieldType.NUMERIC,\n        group: 'General'\n    },\n    'median_price': {\n        type: FieldType.DOLLARS,\n        group: 'Housing'\n    },\n    'median_rent': {\n        type: FieldType.DOLLARS,\n        group: 'Housing'\n    },\n    'mean_commute_time': {\n        type: FieldType.MINUTES,\n        group: 'Commute'\n    },\n    'drive_to_work': {\n        type: FieldType.PERCENT,\n        group: 'Commute'\n    },\n    'carpool_to_work': {\n        type: FieldType.PERCENT,\n        group: 'Commute'\n    },\n    'walk_to_work': {\n        type: FieldType.PERCENT,\n        group: 'Commute'\n    },\n    'transit_to_work': {\n        type: FieldType.PERCENT,\n        group: 'Commute'\n    },\n    'other_to_work': {\n        type: FieldType.PERCENT,\n        group: 'Commute'\n    },\n    'work_from_home': {\n        type: FieldType.PERCENT,\n        group: 'Commute'\n    }\n};\n\nexport type ApiData = {\n    areas: {[id: string]: DataField},\n    levels: {[id: string]: DataField},\n    fields: {[id: string]: DataField},\n    years: { byLevelAndField: {[levelId: string]: {[fieldId: string]: any[]}}}\n    divisions: { byLevel: {[levelId: string]: any[]} }\n    values: { byFieldAndDivision: {[fieldId: string]: any[]} }  // TODO: Division (geoId)?\n    topologies: { byAreaAndLevel: {[areaId: string]: {[levelId: string]: any}}}\n}\n\nexport type Data = {\n    areas: { byId: {[id: string]: DataField}, allIds: string[]}\n    levels: { byId: {[id: string]: DataField}, allIds: string[]}\n    fields: { byId: {[id: string]: DataField}, allIds: string[]}\n    years: { byLevelAndField: {[levelId: string]: {[fieldId: string]: any[]}}}\n    divisions: { byLevel: {[levelId: string]: any[]} }\n    values: { byFieldAndDivision: {[fieldId: string]: any[]} }  // TODO: Division (geoId)?\n    topologies: { byAreaAndLevel: {[areaId: string]: {[levelId: string]: any}}}\n}\n\nexport const getOgImageUrl = (params: IDashboardProps) : string => {\n    return '';\n};\n","import {zipObj, mergeDeepWith, concat, intersection, reduce, tail, all, range, map} from 'ramda';\n\n// bind ::  [a] -> (a -> [b]) -> [b]\nconst bind = xs => f => xs.flatMap(f);\n\n// foldr :: (a -> b -> b) -> b -> [a] -> b\nconst foldr = f => a => xs =>\n    xs.reduceRight((a, x) => f(x)(a), a);\n\nexport const cartProdN = foldr(\n    xs => as =>\n        bind(as)(\n            x => bind(xs)(\n                a => [\n                    [a].concat(x)\n                ]\n            )\n        )\n)([\n    []\n]);\n\nexport type ObjWithId = {id: string};\n\nexport function normalize<T extends ObjWithId>(objArray: T[]) : { [key: string]: T } {\n    return zipObj(objArray.map(item => item.id), objArray);\n}\n\nexport const mergeDeepWithConcat = mergeDeepWith((x, y) => Array.isArray(x) ? concat(x, y) : y);\n\nexport const intersectAll = (xs) => reduce(intersection, xs[0], tail(xs));\n\nexport const getNestedValues = (obj: Object, level: number = 1) : any[] => {\n    const vals = Object.values(obj);\n    if (level > 1)\n        return vals.flatMap(v => getNestedValues(level - 1, v));\n    else\n        return vals.flatMap(v => Object.values(v));\n}\n\nexport const invertMapOfMaps = (\n    obj: {[key1: string]: {[key2: string]: any[]}}\n) : {[key2: string]: {[key1: string]: any[]}} => {\n    const outerKeys = Object.keys(obj);\n    if (outerKeys.length === 0)\n        return {}\n    const arrayLength = Object.values(obj[outerKeys[0]]).length;\n    if (!all(k => Object.values(obj[k]).length === arrayLength, outerKeys))\n        throw new Error(\"All arrays must be the same length.\");\n    const r = range(0, arrayLength);\n    const innerKeys = Object.keys(obj[outerKeys[0]]);\n    const vals = r.map(i => zipObj(outerKeys, outerKeys.map(k => obj[k][innerKeys[i]])));\n    return zipObj(innerKeys, vals);\n}\n\nexport const invertNestedObject = x => {\n    return x == null || Object.values(x)[0] == null ? null :\n        Object.entries(x).reduce((acc, [innerKey, obj]) => {\n            Object.entries(obj).forEach(([outerKey, val]) => {\n                acc[outerKey] = acc[outerKey] || {}; // grab the object already stored at the `outerKey` or create a new one.\n                acc[outerKey][innerKey] = val;\n            })\n            return acc;\n        }, {});\n};\n\nexport const filterKeys = (pred: (string) => boolean, obj: Object) : Object =>\n    Object.fromEntries(Object.entries(obj).filter(([key]) => pred(key)));\n\n// export const sortArrayBy = (array1: any[], array2: any[]) : any[] => {\n//       return array1.slice().sort(function(a, b){\n//           return array2.indexOf(a) - array2.indexOf(b);\n//       });\n// };\n","import {createSelector, createSlice, PayloadAction} from '@reduxjs/toolkit';\nimport {RootState} from '../../app/store';\nimport {\n    ApiData,\n    Data,\n    DataField,\n    FIELD_CFGS,\n    FieldType\n} from \"../../dashboard/config\";\nimport {mergeDeepWithConcat} from \"../../dashboard/utils/misc\";\nimport {map} from 'ramda';\n\n// export const incrementAsync = createAsyncThunk(\n//     'counter/fetchCount',\n//     async (amount: number) => {\n//         const response = await dataSplitter.fetchChunks()\n//         // The value we return becomes the `fulfilled` action payload\n//         return response.data;\n//     }\n// );\n\nexport interface DataState {\n    value: Data,\n    status: 'idle' | 'loading' | 'failed';\n}\n\nconst initialState: DataState = {\n    value: {\n        levels: {byId: {}, allIds: []},\n        areas: {byId: {}, allIds: []},\n        fields: {byId: {}, allIds: []},\n        years: {byLevelAndField: {}},\n        divisions: {byLevel: {}},\n        values: {byFieldAndDivision: {}},\n        topologies: {byAreaAndLevel: {}}\n    },\n    status: 'idle',\n};\n\nconst augmentField = (f: DataField) : DataField =>\n    ({...f, ...FIELD_CFGS[f.id]});\n\n/**\n * Takes (partial) incoming API data and formats it for Redux store\n */\nconst processData = (data: ApiData) : Data => {\n    // @ts-ignore\n    const newData: Data = {...data};\n    if (!!data.areas) {\n        newData['areas'] = {\n            byId: data.areas,\n            allIds: Object.keys(data.areas)\n        }\n    }\n    if (!!data.levels) {\n        newData['levels'] = {\n            byId: data.levels,\n            allIds: Object.keys(data.levels)\n        }\n    }\n    if (!!data.fields) {\n        newData['fields'] = {\n            byId: map(augmentField, data.fields),\n            allIds: Object.keys(FIELD_CFGS)\n        }\n    }\n    return newData;\n};\n\nexport const dataSlice = createSlice({\n    name: 'data',\n    initialState,\n    // The `reducers` field lets us define reducers and generate associated actions\n    reducers: {\n        // Use the PayloadAction type to declare the contents of `action.payload`\n        setData: (state, action: PayloadAction<ApiData>) => {\n            const data = processData(action.payload);\n            state.value = mergeDeepWithConcat(state.value, data);\n        },\n    }\n});\n\nexport const { setData } = dataSlice.actions;\nexport const selectData = (state: RootState) => state.data.value;\nexport const selectAreas = (state: RootState) => state.data.value?.areas;\nexport const selectFields = (state: RootState) => state.data.value?.fields;\nexport const selectLevels = (state: RootState) => state.data.value?.levels;\nexport const selectTopologiesByAreaAndLevel = (state: RootState) =>\n    state.data.value?.topologies.byAreaAndLevel;\nexport const selectYearsByLevelAndField = (state: RootState) =>\n    state.data.value?.years.byLevelAndField;\nexport const selectDivisionsByLevel = (state: RootState) =>\n    state.data.value?.divisions.byLevel;\nexport const selectValuesByFieldAndDivision = (state: RootState) =>\n    state.data.value?.values.byFieldAndDivision;\n\nexport const selectNumericFields = createSelector(\n    selectData,\n    (data: Data) : DataField[] => {\n        return data.fields ? data.fields.allIds\n            .map(id => data.fields.byId[id])\n            .filter(f =>\n                f.type === FieldType.NUMERIC ||\n                f.type === FieldType.DOLLARS ||\n                f.type === FieldType.MINUTES ||\n                f.type === FieldType.PERCENT\n            ) : null\n    }\n);\n\nexport default dataSlice.reducer;\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport {last} from 'ramda';\nimport { RootState } from '../../app/store';\nimport {dataSlice} from \"../data/dataSlice\";\nimport {Data} from \"../../dashboard/config\";\n\nexport interface YearState {\n  value: number;\n  status: 'idle' | 'loading' | 'failed';\n}\n\nconst initialState: YearState = {\n  value: null,\n  status: 'idle',\n};\n\nexport const yearSlice = createSlice({\n  name: 'year',\n  initialState,\n  reducers: {\n    setYear: (state, action: PayloadAction<number>) => {\n      const value = action.payload;\n      if (value != null && value !== state.value) {\n          state.value = value;\n      }\n    }\n  },\n  extraReducers: {\n    // @ts-ignore\n    [dataSlice.actions.setData]: (state, action: PayloadAction<Data>) => {\n      const data = action.payload;\n      // TODO: I'd like to use the state but it's not set in the store yet.\n      // TODO: Also selectors cannot be run from reducers?\n      // TODO: That'd be the preferred way wouldn't it?\n      if (data.years) {\n        // TODO: We need to know what level and field it actually has\n        // TODO: which might pose a problem because we don't know that\n        // TODO: this reducer runs after the one in controlsSlice.\n        const level = \"state\";\n        const field = \"total_pop\";\n        state.value = last(data.years.byLevelAndField[level][field]);\n      }\n    }\n  }\n});\n\nexport const { setYear } = yearSlice.actions;\nexport const selectYear = (state: RootState) => state.year.value;\nexport default yearSlice.reducer;\n","import {PLOT_TYPES_MAP} from \"../../dashboard/config\";\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { RootState } from '../../app/store';\n\nexport interface PlotTypeState {\n    value: string;\n    status: 'idle' | 'loading' | 'failed';\n}\n\nconst initialState: PlotTypeState = {\n    value: 'map',\n    status: 'idle',\n};\n\nexport const plotTypeSlice = createSlice({\n    name: 'plotType',\n    initialState,\n    // The `reducers` field lets us define reducers and generate associated actions\n    reducers: {\n        // Use the PayloadAction type to declare the contents of `action.payload`\n        setPlotType: (state, action: PayloadAction<string>) => {\n            const value = action.payload;\n            if (value != null && value !== '')\n                state.value = value;\n        },\n    }\n});\n\nexport const { setPlotType } = plotTypeSlice.actions;\nexport const selectPlotType = (state: RootState) => PLOT_TYPES_MAP[state.plotType.value];\nexport default plotTypeSlice.reducer;\n","import {createSlice, PayloadAction} from '@reduxjs/toolkit';\nimport { RootState } from '../../app/store';\nimport {getUrlParams} from \"../../utils\";\n\nexport interface ControlValues {\n    area: string,\n    compare: string,\n    x: string,\n    y: string,\n    z: string\n}\n\nexport interface ControlsState {\n    value: ControlValues\n}\n\nexport interface ControlsStateItem {\n    key: string\n    value: string\n}\n\nconst urlParams = getUrlParams();\n\nconst initialState: ControlsState = {\n    value: {\n        area: \"us\",\n        compare: \"state\",\n        x: urlParams.x,\n        y: urlParams.y,\n        z: urlParams.z\n    }\n};\n\nexport const controlsSlice = createSlice({\n    name: 'controls',\n    initialState,\n    // The `reducers` field lets us define reducers and generate associated actions\n    reducers: {\n        // Use the PayloadAction type to declare the contents of `action.payload`\n        setControl: (state, action: PayloadAction<ControlsStateItem>) => {\n            state.value[action.payload.key] = action.payload.value;\n        },\n        setControls: (state, action: PayloadAction<Object>) => {\n            state.value = {...state.value, ...action.payload};\n        }\n    }\n});\n\nexport const { setControl, setControls } = controlsSlice.actions;\n\nexport const selectActualControlValues = (state: RootState) : ControlValues => {\n    return state.controls.value;\n};\n\nexport default controlsSlice.reducer;\n","import { configureStore, ThunkAction, Action } from '@reduxjs/toolkit';\nimport yearReducer from '../features/year/yearSlice';\nimport plotTypeReducer from '../features/plotType/plotTypeSlice';\nimport dataReducer from '../features/data/dataSlice';\nimport controlsReducer from '../features/controls/controlsSlice';\n\nexport const store = configureStore({\n  reducer: {\n    data: dataReducer,\n    year: yearReducer,\n    plotType: plotTypeReducer,\n    controls: controlsReducer,\n  },\n});\n\nexport type AppDispatch = typeof store.dispatch;\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;\n","import { useEffect } from \"react\"\n\nconst useTouchOutside = (elementRef, onClick) => {\n    useEffect(() => {\n        const clickListener = event => {\n            if (!elementRef.current || elementRef.current.contains(event.target)) {\n                return\n            }\n            onClick(event)\n        }\n        // const moveListener = event => {\n        //     if (!elementRef.current || elementRef.current.contains(event.target)) {\n        //         return\n        //     }\n        //     onMove(event);\n        // }\n        document.addEventListener(\"touchstart\", clickListener)\n        // document.addEventListener(\"mousemove\", moveListener)\n        return () => {\n            document.removeEventListener(\"touchstart\", clickListener)\n            // document.removeEventListener(\"mousemove\", moveListener)\n        }\n    }, [elementRef, onClick])\n}\n\nexport default useTouchOutside\n","import React from 'react';\nimport { Tooltip } from '@visx/tooltip';\nimport { withBoundingRects } from '@visx/bounds';\n\nfunction CustomTooltipWithBounds({\n                                     left: initialLeft,\n                                     top: initialTop,\n                                     offsetLeft = 20,\n                                     offsetTop = 20,\n                                     rect,\n                                     parentRect,\n                                     getRects,\n                                     children,\n                                     style,\n                                     ...otherProps\n                                 }) {\n\n    let left = initialLeft;\n    let top = initialTop;\n\n    if (parentRect) {\n        if (parentRect.width > 0) {\n            if (left + offsetLeft + rect.width > parentRect.width) {\n                left = parentRect.width - rect.width - offsetLeft;\n            }\n            if (left < 0) {\n                left = 0;\n            }\n        }\n\n        if (parentRect.height > 0) {\n            if (top + offsetTop + rect.height > parentRect.height) {\n                top = parentRect.height - rect.height - offsetTop;\n            }\n            if (top < 0) {\n                top = 0;\n            }\n        }\n    }\n\n    return (\n        <Tooltip\n            style={{ top: 0, transform: `translate(${left}px, ${top}px)`, ...style }}\n            {...otherProps}\n        >\n            {children}\n        </Tooltip>\n    );\n}\nexport default withBoundingRects(CustomTooltipWithBounds);\n","import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\nimport type { RootState, AppDispatch } from './store';\n\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","import {createSelector} from \"@reduxjs/toolkit\";\nimport {\n    selectAreas,\n    selectDivisionsByLevel,\n    selectFields,\n    selectLevels,\n    selectNumericFields,\n    selectValuesByFieldAndDivision,\n    selectYearsByLevelAndField,\n    selectTopologiesByAreaAndLevel\n} from \"../features/data/dataSlice\";\nimport {intersectAll, invertNestedObject} from \"./utils/misc\";\nimport {selectActualControlValues} from \"../features/controls/controlsSlice\";\nimport {mapObjIndexed} from \"ramda\";\n\nexport const selectControlValues = createSelector(\n    selectActualControlValues,\n    selectNumericFields,\n    (cv, nfs) => {\n        if (!nfs || nfs.length === 0) {\n            return cv;\n        }\n        return {\n            ...cv,\n            x: cv.x || nfs[0].id,\n            y: cv.y || nfs[1].id,\n            z: cv.z || nfs[2].id\n        }\n    }\n);\n\nexport const selectXyzControlValues = createSelector(\n    selectControlValues,\n    (cv) => ({\n        x: cv.x,\n        y: cv.y,\n        z: cv.z\n    }),\n)\n\nexport const selectNonNullXyzControlArray = createSelector(\n    selectXyzControlValues,\n    (cv) => Object.values(cv).filter(v => !!v)\n);\n\nexport const selectControlFields = createSelector(\n    selectAreas,\n    selectLevels,\n    selectFields,\n    selectControlValues,\n    (areas, levels, fields, values) => {\n        return mapObjIndexed((v, k) => {\n            if (!fields || !v) {\n                return null;\n            }\n            if (k === 'area') {\n                return areas.byId[v];\n            }\n            if (k === 'compare') {\n                return levels.byId[v];\n            } else {\n                return fields.byId[v];\n            }\n        }, values)\n    }\n);\n\nexport const selectCurrentDivisions = createSelector(\n    selectDivisionsByLevel,\n    selectControlValues,\n    (dvsByLevel, cv): any[] =>\n        dvsByLevel[cv.compare]\n);\n\nexport const selectYears = createSelector(\n    selectYearsByLevelAndField,\n    selectControlValues,\n    selectNonNullXyzControlArray,\n    (yblaf, cvs, xyz) => {\n        if (Object.keys(yblaf).length > 0) {\n            return intersectAll(xyz.map(cv => yblaf[cvs.compare][cv]))\n        } else {\n            return [];\n        }\n    }\n);\n\nexport const selectTopologies = createSelector(\n    selectTopologiesByAreaAndLevel,\n    selectControlValues,\n    (tbaal, cvs) => {\n        if (Object.keys(tbaal).length > 0) {\n            return tbaal[cvs.area][cvs.compare];\n        } else {\n            return null;\n        }\n    }\n)\n\nconst processDatasetItem = (vbfad, field) => {\n    return field ? invertNestedObject(vbfad[field]) : null\n};\n\nexport const selectCurrentDataset = createSelector(\n    selectValuesByFieldAndDivision,\n    selectControlValues,\n    (vbfad, cv) => ({\n        byField: {\n            x: vbfad[cv.x],\n            y: vbfad[cv.y],\n            z: vbfad[cv.z]\n        },\n        byYear: invertNestedObject({\n                x: processDatasetItem(vbfad, cv.x),\n                y: processDatasetItem(vbfad, cv.y),\n                z: processDatasetItem(vbfad, cv.z)\n\n        })\n    })\n);\n","import React from \"react\";\nimport {defaultStyles as defaultTooltipStyles, useTooltip} from \"@visx/tooltip\";\nimport {\n    all,\n    curry,\n    groupBy,\n    keys,\n    last,\n    map,\n    range,\n    reduce,\n    tail,\n    values\n} from \"ramda\";\nimport useTouchOutside from \"./useTouchOutside\";\nimport TooltipWithBounds from '../dashboard/CustomTooltipWithBounds';\nimport {animated, useSpring} from \"react-spring\";\nimport {useAppSelector} from \"../app/hooks\";\nimport {selectPlotType} from \"../features/plotType/plotTypeSlice\";\nimport {DataField, FieldType} from \"../dashboard/config\";\nimport {selectControlFields} from \"../dashboard/selectors\";\n\nconst DEFAULT_OPTIONS = {\n    selectedOpacity: 0.8,\n    unselectedOpacity: 0.15,\n    defaultOpacity: 0.6\n};\n\ntype ItemMap = Map<string, any[] | ItemMap>;\ntype KeyValue = any | ((event: Event) => any)\n\nconst groupByKeys = (keyFields: string[], items: any[]) : ItemMap => {\n    const im = groupBy(item => item[keyFields[0]], values(items));\n    if (keyFields.length === 1) {\n        return im;\n    } else {\n        return map(curry(groupByKeys)(tail(keyFields)), im);\n    }\n};\n\nconst lookupKeys = (keys: string[], itemMap: ItemMap) => {\n    return reduce((im, k) => im[k], itemMap, keys);\n};\n\nconst lookupItem = (keys: string[], itemMap: ItemMap) => {\n    const results = lookupKeys(keys, itemMap);\n    if (results.length === 1) {\n        return results[0];\n    } else {\n        throw new Error(`Found ${results.length} results for lookup of ${keys}`);\n    }\n};\n\nconst matchesAllKeys = (keysToMatch: string[], itemKeys: string[]) : boolean => {\n    const n = Math.min(keysToMatch.length, itemKeys.length);\n    // Keys will be coerced into strings, but they might be originally numbers\n    // eslint-disable-next-line eqeqeq\n    return all(i => keysToMatch[i] == itemKeys[i], range(0, n));\n};\n\nconst formatValue = (field: DataField, value) => {\n    const val = Number(value).toLocaleString();\n    if (field.type === FieldType.DOLLARS) {\n        return '$' + val;\n    } else if (field.type === FieldType.MINUTES) {\n        return val + ' minutes';\n    } else if (field.type === FieldType.PERCENT) {\n        return val + '%'\n    } else {\n        return val;\n    }\n};\n\nconst TooltipContent = ({item}) => {\n    const controls = useAppSelector(selectControlFields);\n    const plotType = useAppSelector(selectPlotType);\n    return (\n        <div className='tooltip-content'>\n            <div className='tooltip-title'>\n                <h3>{item.name}</h3>\n                <div className='year'>{item.year}</div>\n            </div>\n            <div className='tooltip-body'>\n                <div>{controls.y.name}: {formatValue(controls.y, item.y)}</div>\n                {plotType.fields.x && (\n                    <div>{controls.x.name}: {formatValue(controls.x, item.x)}</div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nconst useSelect = (items: any[], keyFields: string[],\n                   showLabel, disableInteraction = false) => {\n    const nKeyFields = keyFields.length;\n    const itemMap = groupByKeys(keyFields, items);\n    const [selectedKeys, selectKeys] = React.useState<string[]>(null);\n    const {\n        tooltipOpen,\n        tooltipLeft,\n        tooltipTop,\n        tooltipData,\n        showTooltip,\n        hideTooltip\n    } = useTooltip();\n\n    const select = React.useCallback(\n        (itemKeys: string[]) => {\n            if (!selectedKeys || !matchesAllKeys(selectedKeys, itemKeys)) {\n                selectKeys(itemKeys);\n                const item = lookupItem(itemKeys, itemMap);\n                showTooltip({\n                    tooltipData: <TooltipContent item={item} />,\n                    tooltipLeft: item.scaledX,\n                    tooltipTop: item.scaledY,\n                });\n            }\n        },\n        [showTooltip, itemMap, selectedKeys]\n    );\n\n    const deselect = React.useCallback(() => {\n        selectKeys(null);\n        hideTooltip();\n    }, [hideTooltip]);\n\n    const getKeys = (key1) : string[] => {\n        switch (nKeyFields) {\n            case 1: return [key1];\n            case 2: return [key1, last(keys(itemMap[key1]))];\n            default: throw new Error(\"Unsupported # of keys: \" + nKeyFields);\n        }\n    };\n\n    React.useEffect(() => {\n        if (showLabel) {\n            select(getKeys(showLabel));\n        }\n    });\n\n    const Tooltip = React.memo(() => {\n        const ref = React.useRef(null);\n        // On touch outside isn't needed for closing the tooltip,\n        // but actually to be able to select the next point (on touchscreen)\n        useTouchOutside(ref, deselect);\n        return tooltipData ? (\n            <>\n                {tooltipOpen && tooltipData && (\n                    // @ts-ignore\n                    <TooltipWithBounds\n                        top={tooltipTop}\n                        left={tooltipLeft}\n                        style={{\n                            ...defaultTooltipStyles,\n                            fontSize: '1em',\n                            padding: '0.6em',\n                            margin: '0.75em'\n                        }}\n                        className='tooltip MuiPaper-elevation5'\n                    >\n                        <div ref={ref}>\n                            {tooltipData}\n                        </div>\n                    </TooltipWithBounds>\n                )}\n            </>\n        ) : null;\n    });\n\n    const makeSelectable = React.useCallback((keyValues: any[], c, options= DEFAULT_OPTIONS) => {\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        const [{ animOpacity }, setAnim] = useSpring(() => ({\n            animOpacity: options.defaultOpacity,\n        }));\n        const isSelected = selectedKeys && matchesAllKeys(selectedKeys, keyValues);\n        const opacity = isSelected ? options.selectedOpacity : selectedKeys ? options.unselectedOpacity : options.defaultOpacity;\n        const animate = options.animate == null || options.animate === true;\n        if (animate) {\n            setAnim({animOpacity: opacity});\n            // return React.cloneElement(c, {\n            //     key: keyValues.join('_'),\n            //     fillOpacity: animOpacity.to(x => x),\n            //     strokeOpacity:  animOpacity.to(x => x)\n            // });\n            return (\n                <animated.g\n                    fillOpacity={animOpacity.to(x => x)}\n                    strokeOpacity={animOpacity.to(x => x)}\n                    key={keyValues.join('_')}\n                >\n                    {c}\n                </animated.g>\n            );\n        } else {\n            return React.cloneElement(c, {\n                ...c.props,\n                key: keyValues.join('_'),\n                fillOpacity: opacity,\n                strokeOpacity: opacity\n            });\n        }\n    }, [selectedKeys]);\n\n    const makeInteractive = React.useCallback((keyValues: KeyValue[], c) => {\n        if (disableInteraction) {\n            return c;\n        } else {\n            const callback = (event) => {\n                const resolvedKeyValues = keyValues.map(k => k instanceof Function ? k(event) : k);\n                select(resolvedKeyValues);\n            }\n            return React.cloneElement(c, {\n                ...c.props,\n                onTouchStart: callback,\n                onMouseMove: callback,\n                onMouseLeave: deselect\n            });\n        }\n    }, [select, deselect, disableInteraction]);\n\n    const makeSelectableAndInteractive = React.useCallback(\n            (keyValues: KeyValue[], c, options= DEFAULT_OPTIONS) => {\n                const concreteKeys = keyValues.filter(k => !(k instanceof Function))\n        return makeInteractive(keyValues, makeSelectable(concreteKeys, c, options));\n    }, [makeSelectable, makeInteractive]);\n\n    return {makeSelectable, makeInteractive, makeSelectableAndInteractive, Tooltip};\n};\n\nexport default useSelect;\n","import {invertMapOfMaps} from \"./misc\";\nimport {toPairs, map} from 'ramda';\n\nexport const prepareData = (dataByYear, year) => {\n    const dataArray = invertMapOfMaps(dataByYear[year]);\n    return toPairs(map(v => ({\n        ...v,\n        year\n    }), dataArray));\n};\n\nexport const allValuesNotNull = (obj: Object) : boolean =>\n    Object.values(obj).every(f => f != null);\n","import React from \"react\";\nimport {animated, useSpring} from 'react-spring';\nimport {extent} from 'd3-array';\nimport {scaleLinear, scalePower} from \"@visx/scale\";\nimport useSelect from \"../hooks/useSelect\";\nimport {useAppSelector} from \"../app/hooks\";\nimport {selectYear} from \"../features/year/yearSlice\";\nimport {selectCurrentDivisions} from \"./selectors\";\nimport {getNestedValues} from \"./utils/misc\";\nimport {prepareData} from \"./utils/domain\";\n\nconst paddingPct = 0.1;\n\nexport type BubblePlotProps = {\n    data: any\n    showLabel?: string\n    disableInteraction?: boolean\n    width: number\n    height: number\n};\n\nconst DumbBubblePlot = ({\n    data,\n    showLabel = null,\n    disableInteraction = false,\n    width,\n    height,\n    year,\n    divisions\n}) => {\n    const scaleFactor = Math.min(width, height) / 100;\n    const padding = Math.min(width, height) * paddingPct;\n    const xScale = scaleLinear<number>({\n        domain: extent(getNestedValues(data.byField.x)),\n        range: [padding, width - padding],\n        round: true\n    });\n    const yScale = scaleLinear<number>({\n        domain: extent(getNestedValues(data.byField.y)),\n        range: [height - padding / 2, padding],\n        round: true\n    });\n    const sizeScale = scaleLinear<number>({\n        domain: extent(getNestedValues(data.byField.z)),\n        range: [scaleFactor, scaleFactor * 10]\n    });\n    const items = prepareData(data.byYear, year)\n        .map(([k, v]) => ({\n            ...divisions[k],\n            ...v,\n            scaledX: xScale(v.x),\n            scaledY: yScale(v.y),\n            size: sizeScale(v.z)\n        }));\n\n    const {makeSelectableAndInteractive, Tooltip} =\n        useSelect(items, ['name'], showLabel, disableInteraction);\n    return (\n        <>\n            <svg width={width} height={height}>\n                {items.map(item => {\n                    // eslint-disable-next-line react-hooks/rules-of-hooks\n                    const [{animX, animY, animSize}, setAnim] = useSpring(() => ({\n                        animX: item.scaledX,\n                        animY: item.scaledY,\n                        animSize: item.size\n                    }));\n\n                    setAnim({\n                        animX: item.scaledX,\n                        animY: item.scaledY,\n                        animSize: item.size\n                    })\n\n                    return makeSelectableAndInteractive([item.name],\n                        <animated.circle\n                            cx={animX}\n                            cy={animY}\n                            r={animSize}\n                            fill={'#3188f6EE'}\n                            stroke={'#3188f6'}\n                        />\n                    );\n                })}\n            </svg>\n            <Tooltip />\n        </>\n    );\n};\n\nconst BubblePlot = (props: BubblePlotProps) => {\n    const year = useAppSelector(selectYear);\n    const divisions = useAppSelector(selectCurrentDivisions);\n    return year && divisions &&\n        <DumbBubblePlot {...props} year={year} divisions={divisions} />\n};\n\nexport default BubblePlot;\n","import React from 'react';\nimport { geoCentroid, geoAlbersUsa } from 'd3-geo';\nimport {animated, useSpring} from 'react-spring';\nimport { AlbersUsa } from '@visx/geo';\nimport * as topojson from 'topojson-client';\nimport {extent} from 'd3-array';\nimport {zipObj, toPairs} from \"ramda\";\nimport { hcl } from 'd3-color';\nimport { scaleLinear } from 'd3-scale';\nimport { interpolateHcl } from 'd3-interpolate';\nimport {useAppSelector} from \"../app/hooks\";\nimport {selectYear} from \"../features/year/yearSlice\";\nimport useSelect from \"../hooks/useSelect\";\nimport {DataField} from \"./config\";\nimport {selectCurrentDivisions, selectTopologies} from \"./selectors\";\nimport {getNestedValues} from \"./utils/misc\";\n\nexport const borderColor = '#FFF';\n\nexport type MapPlotProps = {\n    width: number\n    height: number\n    data: any\n    yAxisVar: DataField\n    showLabel?: string\n    disableInteraction?: boolean\n};\n\ninterface FeatureShape {\n    type: 'Feature';\n    id: string;\n    geometry: { coordinates: topojson.Position[][]; type: 'MultiPolygon' };\n    properties: { };\n}\nconst projection = geoAlbersUsa();\n\nconst opacityOptions = {\n    selectedOpacity: 1,\n    unselectedOpacity: 0.2,\n    defaultOpacity: 1\n};\n\nconst DumbMapPlot = ({ data, width, height, year, divisions, topologies,\n                         showLabel = null, disableInteraction = false }) => {\n    const centerX = width / 2;\n    const centerY = height / 2;\n    const scale = Math.round(Math.min(width, height) * 1.4);\n\n    // @ts-ignore\n    const { features: unitedStates } = topojson.feature(topologies, topologies.objects.data) as {\n        type: 'FeatureCollection';\n        features: FeatureShape[];\n    };\n\n    const colorScale = scaleLinear()\n        .domain(extent(getNestedValues(data.byField.y)))\n        // @ts-ignore\n        .range([\n            hcl('rgba(41,122,204,0.1)'),\n            hcl('#0265c9')])\n        // @ts-ignore\n        .interpolate(interpolateHcl)\n\n    const items = toPairs(data.byYear[year].y)\n        .map(([k, y]) => ({\n            ...divisions[k],\n            y,\n            year,\n            color: colorScale(y),\n        }));\n    const itemMap = zipObj(items.map(d => d.geoid), items);\n\n    const ifs = unitedStates\n        .map((f) => {\n            const c = projection(geoCentroid(f));\n            return {\n                ...itemMap[f.id],\n                scaledX: c[0] / 1.55,\n                scaledY: c[1] / 1.55\n            };\n        });\n\n    const {makeSelectableAndInteractive, Tooltip} =\n        useSelect(ifs, ['name'], showLabel, disableInteraction);\n\n    return width < 10 ? null : (\n        <>\n            <svg width={width} height={height}>\n                <AlbersUsa<FeatureShape>\n                    data={unitedStates}\n                    scale={scale}\n                    translate={[centerX, centerY]}\n                >\n                    {({ features}) =>\n                        features\n                            .map(({ feature, path }) => {\n                                const item = itemMap[feature.id];\n\n                                // eslint-disable-next-line react-hooks/rules-of-hooks\n                                const [{ animColor }, setAnim] = useSpring(() => ({\n                                    animColor: item.color\n                                }));\n\n                                setAnim({\n                                    animColor: item.color\n                                });\n                                return makeSelectableAndInteractive([item.name],\n                                    <animated.path\n                                        d={path || ''}\n                                        fill={animColor.to(x => x)}\n                                        stroke={borderColor}\n                                        strokeWidth={1}\n                                    />, opacityOptions\n                                )\n                            })\n                    }\n                </AlbersUsa>\n            </svg>\n            <Tooltip />\n        </>\n    );\n};\n\nconst MapPlot = (props: MapPlotProps) => {\n    const year = useAppSelector(selectYear);\n    const divisions = useAppSelector(selectCurrentDivisions);\n    const topologies = useAppSelector(selectTopologies);\n    return year && divisions && topologies &&\n      <DumbMapPlot {...props} year={year} divisions={divisions} topologies={topologies} />\n}\n\nexport default MapPlot;\n","import React from 'react';\nimport { LinePath } from '@visx/shape';\nimport {extent} from 'd3-array';\nimport {scaleLinear} from \"@visx/scale\";\nimport {GlyphCircle} from '@visx/glyph';\nimport { localPoint } from '@visx/event';\nimport { voronoi } from '@visx/voronoi';\nimport {groupBy, curry} from \"ramda\";\nimport useSelect from \"../hooks/useSelect\";\nimport {useAppSelector} from \"../app/hooks\";\nimport {selectCurrentDivisions} from \"./selectors\";\nimport {mapObjIndexed} from \"ramda\";\n\nconst paddingPct = 0.015;\n\nexport type ScatterPlotProps = {\n    data: any\n    showLabel?: string\n    disableInteraction?: boolean\n    width: number\n    height: number\n};\n\nconst lineOptions = {\n    selectedOpacity: 0.9,\n    unselectedOpacity: 0.15,\n    defaultOpacity: 0.6\n};\n\nconst pointOptions = {\n    selectedOpacity: 1,\n    unselectedOpacity: 0,\n    defaultOpacity: 0,\n    animate: false\n};\n\nconst convertData = (ds: Object) : any[] => {\n    const a = mapObjIndexed((yvs, id) =>\n            mapObjIndexed((y, year) => ({\n                id,\n                year,\n                y\n            }), yvs)\n        , ds);\n    return Object.values(a).flatMap(a2 => Object.values(a2));\n};\n\nconst DumbLinePlot = ({\n    data,\n    showLabel = null,\n    disableInteraction = false,\n    width,\n    height,\n    divisions\n}) => {\n    const padding = React.useMemo(() =>\n            Math.min(width, height) * paddingPct,\n        [width, height]\n    );\n    const dataArray = convertData(data.byField.y);\n\n    const xScale = scaleLinear<number>({\n        domain: extent(dataArray, d => +d.year),\n        range: [padding, width - padding],\n        round: true\n    });\n    const yScale = scaleLinear<number>({\n        domain: extent(dataArray, d => +d.y),\n        range: [height - padding, padding],\n        round: true\n    });\n    const items = dataArray\n        .map(d => ({\n            ...divisions[d.id],\n            ...d,\n            scaledX: xScale(d.year),\n            scaledY: yScale(d.y),\n        }));\n\n    const lines = groupBy(d => d.name, items);\n    const lineKeys = Object.keys(lines);\n    const {makeSelectable, makeSelectableAndInteractive, Tooltip} =\n        useSelect(items, ['name', 'year'], showLabel, disableInteraction);\n    const scaledX = (d) => d.scaledX;\n    const scaledY = (d) => d.scaledY;\n    const strokeWidth = Math.max(Math.round(width / 150), 1);\n    const circleSize = Math.round(strokeWidth * 16);\n\n    const voronoiInstance = voronoi({\n        x: scaledX,\n        y: scaledY,\n        width,\n        height\n    });\n\n    const findNearest = (line, event) => {\n        const point = localPoint(event);\n        const nearest = voronoiInstance(line).find(point.x, point.y).data;\n        return nearest.year;\n    };\n\n    return (\n        <>\n            <svg width={width} height={height}>\n                <>\n                    {lineKeys.map((key) => {\n                        const line = lines[key];\n                        return (\n                            <g key={key}>\n                                {makeSelectableAndInteractive([line[0].name, curry(findNearest)(line)],\n                                    <LinePath\n                                    data={line}\n                                    x={(point: any) => point.scaledX}\n                                    y={(point: any) => point.scaledY}\n                                    stroke='#3188f6'\n                                    strokeWidth={strokeWidth}\n                                    />, lineOptions\n                                )}\n                                {line.map(point => makeSelectable([point.name, point.year],\n                                    <GlyphCircle\n                                    left={point.scaledX}\n                                    top={point.scaledY}\n                                    fill='#3188f6'\n                                    stroke='#FFFFFF'\n                                    size={circleSize}\n                                    strokeWidth={Math.max(strokeWidth / 3, 1)}\n                                    />, pointOptions\n                                ))}\n                            </g>\n                        );\n                    })}\n                </>\n            </svg>\n            <Tooltip />\n        </>\n    );\n};\n\nconst LinePlot = (props: ScatterPlotProps) => {\n    const divisions = useAppSelector(selectCurrentDivisions);\n    return divisions && <DumbLinePlot {...props} divisions={divisions} />;\n}\n\nexport default LinePlot;\n","import React from \"react\";\nimport {max} from 'd3-array';\nimport {scaleBand, scaleLinear} from \"@visx/scale\";\nimport useSelect from \"../hooks/useSelect\";\nimport {animated, useSpring} from 'react-spring';\nimport {useAppSelector} from \"../app/hooks\";\nimport {selectYear} from \"../features/year/yearSlice\";\nimport {getNestedValues} from \"./utils/misc\";\nimport {selectCurrentDivisions} from \"./selectors\";\nimport {prepareData} from \"./utils/domain\";\n\nconst hPaddingPct = 0.015;\nconst vPaddingPct = 0.02\n\nexport type ScatterPlotProps = {\n    data: any\n    showLabel?: string\n    disableInteraction?: boolean\n    width: number\n    height: number\n};\n\nconst DumbBarPlot = ({\n    data,\n    showLabel = null,\n    disableInteraction = false,\n    width,\n    height,\n    divisions,\n    year\n}) => {\n    const hPadding = React.useMemo(() =>\n        Math.min(width, height) * hPaddingPct,\n        [width, height]\n    );\n    const vPadding = React.useMemo(() =>\n        Math.min(width, height) * vPaddingPct,\n        [width, height]\n    );\n    const tempItems = prepareData(data.byYear, year)\n        .map(([k, v]) => ({\n            ...divisions[k],\n            ...v\n        }));\n\n    const xScale = React.useMemo(() => scaleBand<string>({\n        range: [hPadding, width - hPadding],\n        round: false,\n        domain: tempItems.map(item => item.name),\n        padding: 0.25,\n    }), [tempItems, hPadding, width]);\n    const yScale = React.useMemo(() => scaleLinear<number>({\n        domain: [0, max(getNestedValues(data.byField.y))],\n        range: [height - vPadding, vPadding],\n        round: true\n    }), [data, height, vPadding]);\n\n    const items = tempItems.map(item => ({\n        ...item,\n        scaledX: xScale(item.name),\n        scaledY: yScale(item.y)\n    }));\n\n    const {makeSelectableAndInteractive, Tooltip} =\n        useSelect(items, ['name'], showLabel, disableInteraction);\n\n    return (\n        <>\n            <svg width={width} height={height - vPadding}>\n                {items.map(item => {\n                    // eslint-disable-next-line react-hooks/rules-of-hooks\n                    const [{ animY }, setAnim] = useSpring(() => ({\n                        animY: item.scaledY\n                    }));\n\n                    setAnim({\n                        animY: item.scaledY\n                    });\n\n                    return makeSelectableAndInteractive([item.name],\n                        <animated.rect\n                            y={animY.to(x => x)}\n                            height={animY.to(x => height - x)}\n                            x={item.scaledX}\n                            width={xScale.bandwidth()}\n                            fill='#318Cf6'\n                        />\n                    )\n                })}\n            </svg>\n            <Tooltip />\n        </>\n    );\n};\n\nconst BarPlot = (props: ScatterPlotProps) => {\n    const year = useAppSelector(selectYear);\n    const divisions = useAppSelector(selectCurrentDivisions);\n    return year && divisions &&\n      <DumbBarPlot {...props} year={year} divisions={divisions} />\n}\n\nexport default BarPlot;\n","import React from \"react\";\nimport useMediaQuery from '@mui/material/useMediaQuery';\nimport {TransitionProps} from \"@mui/material/transitions\";\nimport {\n    Button,\n    Collapse,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    FormControl,\n    FormControlLabel,\n    FormGroup,\n    IconButton,\n    InputLabel,\n    NativeSelect,\n    Switch,\n    TextField\n} from \"@mui/material\";\nimport {\n    FacebookIcon,\n    FacebookShareButton,\n    LinkedinIcon,\n    LinkedinShareButton,\n    PinterestIcon,\n    PinterestShareButton,\n    RedditIcon,\n    RedditShareButton,\n    TwitterIcon,\n    TwitterShareButton,\n} from \"react-share\";\nimport FileCopyOutlinedIcon from '@mui/icons-material/FileCopyOutlined';\nimport * as htmlToImage from 'html-to-image';\nimport {\n    AxisLabelSource, PlotType,\n    SHARE_SIZE_MAP,\n    SHARE_SIZES,\n    ShareSize\n} from \"./config\";\nimport {CopyToClipboard} from 'react-copy-to-clipboard';\nimport {useAppSelector} from \"../app/hooks\";\nimport {selectPlotType} from \"../features/plotType/plotTypeSlice\";\nimport {selectYear} from \"../features/year/yearSlice\";\nimport {selectCurrentDivisions} from \"./selectors\";\nimport './sharing.scss';\nimport {useTheme} from \"@mui/system\";\nimport {compose} from 'ramda';\n\nconst ZOOM = 1;\nconst MAX_PREVIEW_WIDTH = 208 / ZOOM;\nconst MAX_PREVIEW_HEIGHT = 208 / ZOOM;\n\nconst calculatePreviewSize = ({width, height}) => {\n    const ratio = height / width;\n    const h1 = Math.min(ratio * MAX_PREVIEW_WIDTH, MAX_PREVIEW_HEIGHT);\n    const w = Math.min(h1 / ratio, MAX_PREVIEW_WIDTH);\n    const h = Math.min(w * ratio);\n    return {width: w, height: h};\n};\n\nconst ShareTransition = React.forwardRef(function Transition(\n    props: TransitionProps & { children?: React.ReactElement<any, any> },\n    ref: React.Ref<unknown>,\n) {\n    return <Collapse ref={ref} {...props} timeout={500} />;\n});\n\nconst BaseDialog = ({setOpen, children, fullScreen=false}) => {\n    React.useEffect(() => {\n        window.location.hash = \"#dialog\";\n        const onHashChange = () => setOpen(window.location.hash === \"#dialog\");\n        window.addEventListener(\"hashchange\", onHashChange);\n        return () => window.removeEventListener(\"hashchange\", onHashChange);\n    }, []);\n\n    return (\n        <Dialog\n            className='share-dialog'\n            open={true}\n            onClose={() => window.history.back()}\n            fullScreen={fullScreen}\n            keepMounted\n        >\n            {children}\n        </Dialog>\n    );\n};\n\nconst createPlotTitle = (plotType: PlotType, year: number, compareByVar, xAxisLabel, yAxisLabel) => {\n    return (!plotType.xAxisLabelSource || plotType.xAxisLabelSource === AxisLabelSource.COMPARE ?\n        yAxisLabel + ' by ' +\n        compareByVar.toLowerCase()\n        :\n        yAxisLabel + ' / ' +\n        xAxisLabel.toLowerCase() + ' by ' +\n        compareByVar.toLowerCase()) +\n        (plotType.name === 'line' ? '' : ` (${year})`)\n};\n\nexport const DumbImageDialog = ({plot, setOpen, label, setLabel,\n                                compareByVar, xAxisLabel, yAxisLabel, showAxisLabels,\n                                plotType, year, items}) => {\n    const theme = useTheme();\n    const fullScreen = useMediaQuery(theme.breakpoints.down('sm'));\n    const plotTitle = createPlotTitle(plotType, year, compareByVar, xAxisLabel, yAxisLabel);\n    const defaultShareSize = SHARE_SIZES[0];\n    const [sharePresetSize, setSharePresetSize] = React.useState(defaultShareSize);\n    const [previewSize, setPreviewSize] = React.useState({\n        width: MAX_PREVIEW_WIDTH,\n        height: MAX_PREVIEW_HEIGHT\n    });\n    const [shareSize, setShareSize] = React.useState({\n        width: defaultShareSize.width,\n        height: defaultShareSize.height\n    });\n    const [format, setFormat] = React.useState('PNG');\n    const [imgData, setImgData] = React.useState<string>(null);\n\n    const canvasToPng = (canvas) => {\n        return canvas.toDataURL(\"image/png\", 1.0);\n    };\n\n    const getGenerateFn = () => {\n        switch (format) {\n            case 'PNG': return compose(p => p.then(canvasToPng), htmlToImage.toCanvas);\n            case 'SVG': return htmlToImage.toSvg;\n            default: throw Error('Unhandled format: ' + format);\n        }\n    };\n\n    const GenerateDialog = ({setImgData}) => {\n        const generate = () => {\n            const el: any = document\n                .getElementById('preview')\n                .getElementsByClassName('gen-target')[0];\n            getGenerateFn()(el, {\n                canvasWidth: shareSize.width,\n                canvasHeight: shareSize.height,\n                // width: shareSize.width * 4,\n                // height: shareSize.height * 4,\n                quality: 1.0,\n                style: {\n                    // @ts-ignore\n                    // zoom: 1\n                    // width: shareSize.width * 4 + 'px',\n                    // height: shareSize.height * 4 + 'px'\n                }\n            }).then((dataUrl) => {\n                setImgData(dataUrl);\n            });\n        };\n\n        const setNewSize = (newSize) => {\n            setShareSize(newSize);\n            setPreviewSize(calculatePreviewSize(newSize));\n        };\n\n        const onPresetSizeSelect = (event) => {\n            const name = event.target.value;\n            if (name === 'Custom') {\n                setSharePresetSize(null);\n                document\n                    .getElementsByClassName('MuiDialog-container')[0]\n                    .getElementsByClassName('MuiPaper-root')[0]\n                    .scrollTo(0, 9999);\n            } else {\n                const s = SHARE_SIZE_MAP[name];\n                setSharePresetSize(s);\n                setNewSize(s);\n            }\n        };\n\n        const onSizeChange = (newSize) => {\n            setSharePresetSize(null);\n            setNewSize(newSize);\n        };\n\n        const onLabelChange = (event) => {\n            const value = event.target.value;\n            setLabel(value === ' ' ? null : value);\n        };\n\n        const onFormatChange = (event) => {\n            const value = event.target.value;\n            setFormat(value);\n        }\n\n        const fontSize = Math.round(previewSize.width / 40);\n\n        return (\n            <>\n                <div className='dialog-title'>Generate image</div>\n                <DialogContent className='dialog-content'>\n                    <div id='preview-container'>\n                        <div id='preview' style={{...previewSize, fontSize}}>\n                            <div className='gen-target'>\n                                <div className='plot-frame'>\n                                    <div className='title'>{plotTitle}</div>\n                                    <div className='subtitle'>\n                                        Statistipedia: statistipedia.org/explore\n                                    </div>\n                                    {plot}\n                                </div>\n                                { showAxisLabels && xAxisLabel &&\n                                <div className='x-axis'>\n                                    {xAxisLabel || 'Year'}\n                                </div>\n                                }\n                                { showAxisLabels && yAxisLabel &&\n                                <div className='y-axis'>\n                                    {yAxisLabel}\n                                </div>\n                                }\n                            </div>\n                        </div>\n                        <div className=\"MuiFormLabel-root caption\">\n                            Preview\n                        </div>\n                    </div>\n                    <div className='share-controls'>\n                        <div className='size-inputs'>\n                            <FormControl>\n                                <InputLabel variant=\"standard\" htmlFor=\"preset-size\">Size</InputLabel>\n                                <NativeSelect id=\"preset-size\"\n                                              onChange={onPresetSizeSelect}\n                                              value={sharePresetSize ? sharePresetSize.name : 'Custom'}>\n                                    <optgroup label=\"Presets\">\n                                        {SHARE_SIZES.map((s) => (\n                                            <option key={s.name}>{s.name}</option>\n                                        ))}\n                                    </optgroup>\n                                    <option>Custom</option>\n                                </NativeSelect>\n                            </FormControl>\n                            <FormGroup row className='custom-size-inputs top-padded row'>\n                                {['width', 'height'].map((s) => (\n                                    <FormControl key={s} className='top-padded custom-size-input'>\n                                        <TextField helperText={s}\n                                                   variant=\"standard\"\n                                                   onChange={(event) =>\n                                                       onSizeChange({...shareSize, [s]: event.target.value})}\n                                                   value={shareSize[s]} />\n                                    </FormControl>\n                                ))}\n                            </FormGroup>\n                            <FormGroup row className='row'>\n                                <FormControl className=\"form-control\">\n                                    <InputLabel variant=\"standard\" htmlFor=\"label\">Labeled item</InputLabel>\n                                    <NativeSelect id=\"label\"\n                                                  value={label ? label : ' '}\n                                                  onChange={onLabelChange}>\n                                        <option value=' ' />\n                                        {items.map(({name}) => (\n                                            <option key={name}>{name}</option>\n                                        ))}\n                                    </NativeSelect>\n                                </FormControl>\n                            </FormGroup>\n                            <FormGroup row className='top-padded row'>\n                                <FormControl className=\"form-control\">\n                                    <InputLabel variant=\"standard\" htmlFor=\"format\">Format</InputLabel>\n                                    <NativeSelect id=\"format\"\n                                                  value={format}\n                                                  onChange={onFormatChange}\n                                    >\n                                        <option>PNG</option>\n                                        <option>SVG</option>\n                                    </NativeSelect>\n                                </FormControl>\n                                <FormControl className=\"form-control\">\n                                    <InputLabel variant=\"standard\" htmlFor=\"light_dark\">\n                                        Mode\n                                    </InputLabel>\n                                    <NativeSelect id=\"light_dark\" value='Light mode'>\n                                        <option>Light</option>\n                                        <option>Dark</option>\n                                    </NativeSelect>\n                                </FormControl>\n                            </FormGroup>\n                            <FormControl className=\"form-control\">\n                                <FormControlLabel\n                                    control={\n                                        <Switch\n                                            color=\"primary\"\n                                        />\n                                    }\n                                    label=\"Add QR code\"\n                                />\n                            </FormControl>\n                        </div>\n                    </div>\n                </DialogContent>\n                <DialogActions className='dialog-actions'>\n                    <Button onClick={() => window.history.back()}>Close</Button>\n                    <Button onClick={generate}>Generate</Button>\n                </DialogActions>\n            </>\n        );\n    };\n\n    const DownloadDialog = ({imgData, setImgData}) => {\n        const url = window.location.href;\n\n        // const share = () => {\n        //     if (navigator.share) {\n        //         navigator.share({\n        //             title: 'web.dev',\n        //             text: 'Check out web.dev.',\n        //             // url: 'https://web.dev/',\n        //             files: [image]\n        //         })\n        //             .then(() => alert('Successful share'))\n        //             .catch((error) => alert(error));\n        //     }\n        // };\n        return (\n            <>\n                <div className='dialog-title'>Download image</div>\n                <DialogContent className='dialog-content'>\n                    <div className='generated-image'>\n                        <a download={plotTitle} href={imgData}>\n                            <img alt=\"Generated\" src={imgData} />\n                        </a>\n                    </div>\n                    <div className='share-controls'>\n                        <div className='image-share-btns'>\n                            <div className='image-share-btn'>\n                                <PinterestShareButton\n                                    url={url}\n                                    media={imgData}\n                                >\n                                    <PinterestIcon round />\n                                    <div style={{color: '#C9242E'}}>\n                                        Share on Pinterest\n                                    </div>\n                                </PinterestShareButton>\n                            </div>\n                        </div>\n                    </div>\n                </DialogContent>\n                <DialogActions className='dialog-actions'>\n                    <Button onClick={() => setImgData(null)}>Back</Button>\n                    <Button onClick={() => window.history.back()}>Close</Button>\n                    <Button href={imgData} download={plotTitle}>Download</Button>\n                </DialogActions>\n            </>\n        )\n    };\n    return (\n        <BaseDialog setOpen={setOpen} fullScreen={fullScreen}>\n            {imgData\n                ? <DownloadDialog imgData={imgData} setImgData={setImgData} />\n                : <GenerateDialog setImgData={setImgData} />\n            }\n        </BaseDialog>\n    )\n}\n\nexport const ImageDialog = (props) => {\n    const plotType = useAppSelector(selectPlotType);\n    const year = useAppSelector(selectYear);\n    const items = Object.values(useAppSelector(selectCurrentDivisions));\n    return <DumbImageDialog {...props} plotType={plotType} year={year} items={items} />\n};\n\nexport const ShareDialog = ({setOpen, compareByVar, xAxisLabel, yAxisLabel}) => {\n    const url = window.location.href;\n    const plotType = useAppSelector(selectPlotType);\n    const year = useAppSelector(selectYear);\n    const plotTitle = createPlotTitle(plotType, year, compareByVar, xAxisLabel, yAxisLabel);\n    return (\n        <BaseDialog setOpen={setOpen}>\n            <>\n                <div className='dialog-header'>\n                    <div className='dialog-title'>Share</div>\n                </div>\n                <DialogContent className='dialog-content'>\n                    <div className='social-btns'>\n                        <FacebookShareButton\n                            url={url}\n                            quote={plotTitle}\n                        >\n                            <FacebookIcon round />\n                        </FacebookShareButton>\n                        <TwitterShareButton\n                            url={url}\n                            title={plotTitle}\n                        >\n                            <TwitterIcon round />\n                        </TwitterShareButton>\n                        <RedditShareButton\n                            url={url}\n                            title={plotTitle}\n                        >\n                            <RedditIcon round />\n                        </RedditShareButton>\n                        <LinkedinShareButton url={url}>\n                            <LinkedinIcon round />\n                        </LinkedinShareButton>\n                    </div>\n                    <div style={{display: 'flex'}}>\n                        <TextField value={url} />\n                        <CopyToClipboard onCopy={() => {}} text={url}>\n                            <IconButton aria-label=\"copy\"\n                                        className='copy-btn'\n                                        title='Copy to clipboard'>\n                                <FileCopyOutlinedIcon />\n                            </IconButton>\n                        </CopyToClipboard>\n                    </div>\n                </DialogContent>\n            </>\n        </BaseDialog>\n    );\n};\n","import React from 'react';\nimport { useAppSelector, useAppDispatch } from '../../app/hooks';\nimport { setYear, selectYear } from './yearSlice';\nimport {Box, Slider} from \"@mui/material\";\nimport {styled} from \"@mui/system\";\nimport {selectPlotType} from \"../plotType/plotTypeSlice\";\nimport {last} from 'ramda';\nimport {selectYears} from \"../../dashboard/selectors\";\n\nconst PrettoSlider = styled(Slider)({\n    color: '#318Cf6',\n    height: 8,\n    '& .MuiSlider-track': {\n        border: 'none',\n    },\n    '& .MuiSlider-thumb': {\n        height: 24,\n        width: 24,\n        backgroundColor: '#fff',\n        border: '2px solid currentColor',\n        '&:focus, &:hover, &.Mui-active, &.Mui-focusVisible': {\n            boxShadow: 'inherit',\n        },\n        '&:before': {\n            display: 'none',\n        },\n    },\n    '& .MuiSlider-valueLabel': {\n        lineHeight: 1.2,\n        fontSize: 12,\n        background: 'unset',\n        padding: 0,\n        width: 32,\n        height: 32,\n        borderRadius: '50% 50% 50% 0',\n        backgroundColor: '#318Cf6',\n        transformOrigin: 'bottom left',\n        transform: 'translate(50%, -100%) rotate(-45deg) scale(0)',\n        '&:before': { display: 'none' },\n        '&.MuiSlider-valueLabelOpen': {\n            transform: 'translate(50%, -100%) rotate(-45deg) scale(1)',\n        },\n        '& > *': {\n            transform: 'rotate(45deg)',\n        },\n    },\n    '& .Mui-disabled .MuiSlider-valueLabel': {\n        display: 'none'\n    }\n});\n\nconst YearSlider = () => {\n    const year = useAppSelector(selectYear);\n    const plotType = useAppSelector(selectPlotType);\n    const years = useAppSelector(selectYears);\n    const dispatch = useAppDispatch();\n\n    return plotType && years && year && (\n        <Box sx={{\n            flex: '1 1'\n        }}>\n            <PrettoSlider\n                defaultValue={last(years)}\n                min={years[0]}\n                max={last(years)}\n                step={1}\n                disabled={plotType.name === 'line'}\n                valueLabelDisplay=\"on\"\n                onChange={(event, y: number) => {\n                    if (year !== y) {\n                        dispatch(setYear(y))\n                    }\n                }}\n                sx={{\n                    paddingTop: '20px',\n                    '& .MuiSlider-markLabel': {\n                        top: '40px'\n                    }\n                }}\n            />\n        </Box>\n    );\n}\n\nexport default YearSlider;\n","import {ToggleButton, ToggleButtonGroup} from \"@mui/lab\";\nimport {PLOT_TYPES} from \"../../dashboard/config\";\nimport React from \"react\";\nimport {useAppDispatch, useAppSelector} from \"../../app/hooks\";\nimport {selectPlotType, setPlotType} from \"./plotTypeSlice\";\n\n\nconst PlotTypeSelect = () => {\n    const plotType = useAppSelector(selectPlotType);\n    const dispatch = useAppDispatch();\n\n\n    const changePlotType = (event, name) => {\n        dispatch(setPlotType(name));\n    }\n\n    return (\n        <div className='plot-type'>\n            <ToggleButtonGroup size='small'\n                               value={plotType.name}\n                               exclusive\n                               onChange={changePlotType}>\n                {PLOT_TYPES.map((pt) => (\n                    <ToggleButton key={pt.name} value={pt.name}>\n                        {<pt.icon/>}\n                    </ToggleButton>\n                ))}\n            </ToggleButtonGroup>\n        </div>\n    );\n};\n\nexport default PlotTypeSelect;\n","import PlotTypeSelect from \"../plotType/PlotTypeSelect\";\nimport {\n    Autocomplete,\n    FormControl,\n    InputLabel,\n    NativeSelect,\n    TextField\n} from \"@mui/material\";\nimport React from \"react\";\nimport {useAppDispatch, useAppSelector} from \"../../app/hooks\";\nimport {setControl} from \"./controlsSlice\";\nimport {selectPlotType} from \"../plotType/plotTypeSlice\";\nimport {selectAreas, selectNumericFields} from \"../data/dataSlice\";\nimport {selectControlFields} from \"../../dashboard/selectors\";\nimport {allValuesNotNull} from \"../../dashboard/utils/domain\";\nimport {groupBy} from \"ramda\";\nimport {DataField} from \"../../dashboard/config\";\n\nconst groupFields = (fields: DataField[]) : {name: string, fields: DataField[]}[] => {\n    const gs = groupBy(f => f.group, fields);\n    return Object.keys(gs).map(k => ({ name: k, fields: gs[k] }));\n}\n\nconst Controls = () => {\n    const plotType = useAppSelector(selectPlotType);\n    const controls = useAppSelector(selectControlFields);\n    const controlsIsReady = allValuesNotNull(controls);\n    const numericFields = useAppSelector(selectNumericFields);\n    const areas = useAppSelector(selectAreas);\n    const dispatch = useAppDispatch();\n\n    const numericFieldGroups = groupFields(numericFields);\n\n    const updateState = (newState: {[key: string]: string}) => {\n        const s = {\n            key: Object.keys(newState)[0],\n            value: Object.values(newState)[0]\n        };\n        return dispatch(setControl(s))\n    };\n\n    const FieldSelect = ({field} : {field: string}) => {\n        return (\n            <FormControl className=\"form-control\"\n                         disabled={!plotType.fields[field]}>\n                <InputLabel variant=\"standard\" htmlFor={`field-${field}`}>\n                    {plotType.fields[field] || `${field.toUpperCase()}-Axis`}\n                </InputLabel>\n                <NativeSelect id={`field-${field}`} value={controls[field].id}\n                              onChange={(event) =>\n                                  updateState({[field]: event.target.value})}\n                >\n                    {numericFieldGroups.map(g => (\n                        <optgroup label={g.name} key={g.name}>\n                            {g.fields.map(f => (\n                                <option key={f.id} value={f.id}>{f.name}</option>\n                            ))}\n                        </optgroup>\n                    ))}\n                </NativeSelect>\n            </FormControl>\n        )\n    }\n\n    return controlsIsReady && areas.allIds.length > 0 && (\n        <div className='controls'>\n            <PlotTypeSelect />\n            <Autocomplete\n                id=\"area\"\n                className=\"form-control\"\n                options={areas.allIds}\n                value={controls.area.id}\n                getOptionLabel={(option) => areas.byId[option].name}\n                renderInput={(params) =>\n                    <TextField variant=\"standard\" label='Area' {...params} />}\n            />\n            <FormControl className=\"form-control\">\n                <InputLabel variant=\"standard\" htmlFor=\"compare-by\">Compare by</InputLabel>\n                <NativeSelect id=\"compare-by\" value={controls.compare.id}\n                              onChange={(event) =>\n                                  updateState({compare: event.target.value})}\n                >\n                    <optgroup label='Area'>\n                        <option value='state'>State</option>\n                        <option>County</option>\n                        <option disabled={true}>Place</option>\n                    </optgroup>\n                    <optgroup label='Demographics'>\n                        <option>Sex</option>\n                        <option>Race</option>\n                        <option>Age</option>\n                    </optgroup>\n                </NativeSelect>\n            </FormControl>\n            <FieldSelect field='x' />\n            <FieldSelect field='y' />\n            <FieldSelect field='z' />\n        </div>\n    );\n};\n\nexport default Controls;\n","import {getUrlParams} from \"../../utils\";\nimport axios from 'axios';\n\nexport type Params = Map<string, any>\n\nexport type DataSplittingConfig = {\n    paramsToChunkUrls: (params: Params) => string[],\n    onChunkFetch: (chunk: any) => void\n}\n\nexport const MASTER_CHUNK_FILENAME = 'master.json';\nexport const CHUNK_DIR = \"public/explore/data\";\nconst BASE_CHUNK_URL = \"/explore/data\";\n\nexport const computeValueChunkUrl = (level: string, feature: string) : string => {\n    return 'values.json';\n};\n\nexport const computeTopologyChunkUrl = (area: string, level: string) : string => {\n    return 'topologies.json';\n}\n\nexport class SplittingDataFetcher {\n    private config: DataSplittingConfig;\n\n    constructor(config: DataSplittingConfig) {\n        this.config = config;\n    }\n\n    private _computeChunkUrls = () : string[] => {\n        const urlParams = getUrlParams();\n        return this.config.paramsToChunkUrls(urlParams)\n            .map(u => BASE_CHUNK_URL + '/' + u);\n    };\n\n    private _fetchChunks = (urls: string[]) => {\n        axios.all(urls.map(url => axios.get(url)))\n            .then(axios.spread((...responses) =>\n                responses.map(r => this.config.onChunkFetch(r.data))\n            ));\n    };\n\n    fetchChunks = () => this._fetchChunks(this._computeChunkUrls());\n}\n\n","import React from 'react';\nimport {\n    computeValueChunkUrl,\n    SplittingDataFetcher,\n    MASTER_CHUNK_FILENAME, computeTopologyChunkUrl\n} from \"../../dashboard/utils/dataSplitting\";\nimport {useAppDispatch} from \"../../app/hooks\";\nimport {setData} from \"./dataSlice\";\n\nconst DataManager = () => {\n    const dispatch = useAppDispatch();\n\n    React.useEffect(() => {\n        const paramsToChunkUrls = (params) : string[] => {\n            return [\n                MASTER_CHUNK_FILENAME,\n                computeValueChunkUrl('', ''),\n                computeTopologyChunkUrl('us', 'state')\n            ];\n        };\n\n        const onChunkFetch = (chunk: any): void => {\n            dispatch(setData(chunk));\n        };\n\n        const dataSplitter = new SplittingDataFetcher({\n            paramsToChunkUrls,\n            onChunkFetch\n        });\n         dataSplitter.fetchChunks();\n    }, [dispatch]);\n\n    return null;\n}\n\nexport default DataManager;\n","import React from 'react';\nimport {\n    createEnumParam,\n    NumberParam,\n    StringParam,\n    useQueryParams\n} from \"use-query-params\";\nimport {useAppDispatch, useAppSelector} from \"../app/hooks\";\nimport {selectControlFields} from \"./selectors\";\nimport {selectYear, setYear} from \"../features/year/yearSlice\";\nimport {map, filter, pickBy} from 'ramda';\nimport {selectPlotType, setPlotType} from \"../features/plotType/plotTypeSlice\";\nimport {setControls} from \"../features/controls/controlsSlice\";\nimport {allValuesNotNull} from \"./utils/domain\";\n\nconst Url = () => {\n    const controls = useAppSelector(selectControlFields);\n    const storedYear = useAppSelector(selectYear);\n    const plotType = useAppSelector(selectPlotType);\n    const dispatch = useAppDispatch();\n\n    const [query, setQuery] = useQueryParams({\n        x: StringParam,\n        y: StringParam,\n        z: StringParam,\n        area: StringParam,\n        compare: StringParam,\n        plot: createEnumParam(['line', 'bubble', 'bar', 'map']),\n        year: NumberParam\n    });\n\n    React.useEffect(() => {\n        const { x, y, z, compare, plot, year } = query;\n        const nonNullControls = filter(v => !!v, {x, y, z, compare});\n        dispatch(setControls(nonNullControls));\n        dispatch(setPlotType(plot));\n        dispatch(setYear(year));\n    }, [dispatch]);  // Only run 1st time, so query isn't a dependency\n\n    React.useEffect(() => {\n        if (allValuesNotNull(controls)) {\n            const allParams = {\n                plot: plotType ? plotType.name : null,\n                ...map(f => f ? f.id : null, controls),\n                year: storedYear\n            };\n            const params = filter(p => !!p, allParams);\n            setQuery(params, 'replaceIn');\n        }\n    }, [dispatch, query, setQuery, controls, storedYear, plotType]);\n\n    return null;\n};\n\nexport default Url;\n","import React from 'react';\nimport { Provider } from 'react-redux';\nimport { store } from '../app/store';\nimport {\n    AppBar,\n    Box,\n    Card,\n    CircularProgress,\n    Collapse,\n    CssBaseline,\n    Divider,\n    Drawer,\n    Hidden,\n    IconButton,\n    List,\n    ListItem,\n    ListItemIcon,\n    ListItemText,\n    ThemeProvider,\n    Toolbar,\n    Typography,\n    useMediaQuery\n} from '@mui/material';\nimport { createTheme } from '@mui/material/styles';\nimport BubblePlot from \"./BubblePlot\";\nimport {ParentSize} from \"@visx/responsive\";\nimport './Dashboard.scss';\nimport MenuIcon from \"@mui/icons-material/Menu\";\nimport HomeIcon from \"@mui/icons-material/Home\";\nimport DataIcon from \"@mui/icons-material/Storage\";\nimport ChartIcon from \"@mui/icons-material/InsertChart\";\nimport PlayIcon from '@mui/icons-material/PlayArrow';\nimport ShareIcon from '@mui/icons-material/Share';\nimport PhotoCameraIcon from '@mui/icons-material/PhotoCamera';\nimport ExpandLess from '@mui/icons-material/ExpandLess';\nimport ExpandMore from '@mui/icons-material/ExpandMore';\nimport {AxisLabelSource, IDashboardProps} from \"./config\";\nimport {setUseWhatChange, useWhatChanged} from '@simbathesailor/use-what-changed';\nimport MapPlot from \"./MapPlot\";\nimport LinePlot from \"./LinePlot\";\nimport BarPlot from \"./BarPlot\";\nimport {ImageDialog, ShareDialog} from \"./sharing\";\nimport YearSlider from \"../features/year/YearSlider\";\nimport {useAppSelector} from \"../app/hooks\";\nimport {selectPlotType} from \"../features/plotType/plotTypeSlice\";\nimport Controls from \"../features/controls/Controls\";\nimport DataManager from \"../features/data/DataManager\";\nimport Url from './Url';\nimport {selectControlFields, selectCurrentDataset} from \"./selectors\";\nimport { QueryParamProvider } from 'use-query-params';\nimport {allValuesNotNull} from \"./utils/domain\";\n\nsetUseWhatChange(process.env.NODE_ENV === 'development');\nrequire('typeface-roboto');\n\nconst LoadingPlot = ({width, height}) => (\n    <div className='loading-plot' style={{width, height}}>\n        <CircularProgress variant='indeterminate'\n                          size={Math.min(Math.round(width / 7), 80)} />\n    </div>\n);\n\nconst PlotArea = ({data, loading, plotType,\n                      axisLabels, xAxisLabel=null, yAxisLabel=null,\n                      disableInteraction = false, showLabel,\n                      x, y, sizeVar}) => {\n    const showPlot = (width: number, height: number) => {\n        if (!data)\n            return null;\n        switch (plotType.name) {\n            case 'bubble': return <BubblePlot data={data}\n                                              showLabel={showLabel}\n                                              disableInteraction={disableInteraction}\n                                              width={width}\n                                              height={height} />;\n            case 'line': return <LinePlot data={data}\n                                          showLabel={showLabel}\n                                          disableInteraction={disableInteraction}\n                                          width={width}\n                                          height={height} />;\n            case 'bar': return <BarPlot data={data}\n                                        showLabel={showLabel}\n                                        disableInteraction={disableInteraction}\n                                        width={width}\n                                        height={height} />;\n            default: return <MapPlot data={data}\n                                     showLabel={showLabel}\n                                     disableInteraction={disableInteraction}\n                                     width={width}\n                                     height={height}\n                                     yAxisVar={y} />;\n        }\n    };\n    return (\n        <ParentSize debounceTime={10} className='bg'>\n            {({ width, height }) => {\n                const fontSize = Math.min(Math.round(width / 18), 16);\n                return (width + height) > 0 && (\n                    <div className='plot' style={{width, height, fontSize}}>\n                        {loading &&\n                        <LoadingPlot width={width} height={height}/>}\n                        {showPlot(width, height)}\n                        {axisLabels && !plotType.hideAxisLabels && (\n                            <>\n                                <div className='x-axis'>\n                                    {xAxisLabel || 'Year'}\n                                </div>\n                                <div className='y-axis' style={{width: height}}>\n                                    {yAxisLabel}\n                                </div>\n                            </>\n                        )}\n                    </div>\n                )\n            }}\n        </ParentSize>\n    );\n};\n\nconst SideMenuItem = ({text, icon, children=null}) => {\n    const [open, setOpen] = React.useState(false);\n    return (\n        <>\n            <ListItem button onClick={() => setOpen(!open)}>\n                <ListItemIcon className='menu-item-icon'>{icon}</ListItemIcon>\n                <ListItemText primary={text} />\n                {children && (open ? <ExpandLess /> : <ExpandMore />)}\n            </ListItem>\n            {children && (\n                <Collapse in={open} timeout=\"auto\" unmountOnExit className='nested-menu'>\n                    {children}\n                </Collapse>\n            )}\n        </>\n    );\n};\n\ntype DumbDashboardProps = {\n    plotType: any\n    controls: any\n}\n\nconst DumbDashboard = ({plotType, controls}: DumbDashboardProps) => {\n    const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)');\n\n    const computeXAxisLabel = () : string => {\n        switch (plotType.xAxisLabelSource) {\n            case AxisLabelSource.VAR: return controls.x.name;\n            case AxisLabelSource.COMPARE: return controls.compare.name;\n            case AxisLabelSource.YEAR: return 'Year'\n            default: return null;\n        }\n    };\n\n    const xAxisLabel = computeXAxisLabel();\n    const yAxisLabel = controls.y?.name;\n\n    const theme = React.useMemo(\n        () =>\n            createTheme({\n                palette: {\n                    mode: prefersDarkMode ? 'dark' : 'light',\n                    primary: {\n                        main: prefersDarkMode ? '#175391' : '#2278CF'\n                    }\n                },\n                breakpoints: {\n                    values: {\n                        xs: 1,\n                        sm: 360,\n                        md: 640,\n                        lg: 960,\n                        xl: 1080,\n                    },\n                }\n            }),\n        [prefersDarkMode],\n    );\n\n    const Plot = ({axisLabels, showLabel = null, disableInteraction = false}) => {\n        const data = useAppSelector(selectCurrentDataset);\n        return controls.y && (\n            <PlotArea data={data}\n                      loading={!data}\n                      plotType={plotType}\n                      axisLabels={axisLabels}\n                      disableInteraction={disableInteraction}\n                      showLabel={showLabel}\n                      x={controls.x}\n                      y={controls.y}\n                      xAxisLabel={xAxisLabel}\n                      yAxisLabel={yAxisLabel}\n                      sizeVar={controls.size}\n            />\n        );\n    };\n\n    const SideMenu = () => {\n        const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)');\n        const [drawerOpen, setDrawerOpen] = React.useState(false);\n        const [genImgOpen, setGenImgOpen] = React.useState(false);\n        const [shareOpen, setShareOpen] = React.useState(false);\n        const [showLabel, setShowLabel] = React.useState(null);\n\n        const drawer = (\n            <div className='side-menu'>\n                <Divider />\n                <List>\n                    <a href='/'>\n                        <SideMenuItem text='Statistpedia' icon={<HomeIcon />} />\n                    </a>\n                    <SideMenuItem text='Datasets' icon={<DataIcon />} />\n                    <SideMenuItem text='Presets' icon={<ChartIcon />}>\n                        <List>\n                            <ListItem button>\n                                <ListItemText>\n                                    Home prices vs rents\n                                </ListItemText>\n                            </ListItem>\n                            <ListItem button>\n                                <ListItemText>\n                                    Income by sex\n                                </ListItemText>\n                            </ListItem>\n                        </List>\n                    </SideMenuItem>\n                </List>\n                <Divider />\n            </div>\n        );\n        return (\n            <>\n                <nav>\n                    <Hidden xlUp>\n                        <Drawer\n                            variant=\"temporary\"\n                            open={drawerOpen}\n                            onClose={() => setDrawerOpen(false)}\n                            ModalProps={{\n                                keepMounted: true, // Better open performance on mobile.\n                            }}\n                        >\n                            {drawer}\n                        </Drawer>\n                    </Hidden>\n                    <Hidden xlDown>\n                        <Drawer\n                            variant=\"permanent\"\n                            open\n                        >\n                            {drawer}\n                        </Drawer>\n                    </Hidden>\n                </nav>\n                <AppBar className='top-bar'\n                        position=\"static\"\n                        elevation={prefersDarkMode ? 0 : 1}>\n                    <Toolbar variant=\"dense\">\n                        <IconButton edge=\"start\"\n                                    sx={{\n                                        marginRight: theme.spacing(2),\n                                        display: { xs: 'inline-flex', xl: 'none' }\n                                    }}\n                                    onClick={() => setDrawerOpen(!drawerOpen)}\n                                    color=\"inherit\"\n                                    aria-label=\"menu\">\n                            <MenuIcon />\n                        </IconButton>\n                        <Typography\n                            variant=\"h6\"\n                            style={{fontWeight: 400}}\n                            sx={{\n                                display: ['none', 'block']\n                            }}\n                        >\n                            Statistipedia Explore\n                        </Typography>\n                        <div className=\"grow\" />\n                        <IconButton className='menu-btn'\n                                    onClick={() => setGenImgOpen(true)}\n                                    color=\"inherit\">\n                            <PhotoCameraIcon />\n                        </IconButton>\n                        <IconButton edge=\"end\"\n                                    className='menu-btn'\n                                    onClick={() => setShareOpen(true)}\n                                    color=\"inherit\">\n                            <ShareIcon />\n                        </IconButton>\n                    </Toolbar>\n                </AppBar>\n                {genImgOpen && <ImageDialog\n                                    setOpen={setGenImgOpen}\n                                    label={showLabel}\n                                    setLabel={setShowLabel}\n                                    compareByVar={controls.compare.name}\n                                    xAxisLabel={xAxisLabel}\n                                    yAxisLabel={yAxisLabel}\n                                    showAxisLabels={!plotType.hideAxisLabels}\n                                    plot={<Plot axisLabels={false}\n                                                disableInteraction={true}\n                                                showLabel={showLabel} />} />}\n                {shareOpen && <ShareDialog\n                                  compareByVar={controls.compare.name}\n                                  xAxisLabel={xAxisLabel}\n                                  yAxisLabel={yAxisLabel}\n                                  setOpen={setShareOpen} />}\n            </>\n        );\n    };\n\n    useWhatChanged([plotType, controls]);\n\n    return (\n        <ThemeProvider theme={theme}>\n            <CssBaseline />\n            <Box sx={{\n                boxSizing: 'border-box',\n                width: '100%',\n                height: '100%',\n                display: 'flex',\n                flexDirection: 'column',\n                paddingLeft: { xs: 0, xl: '270px' }\n            }}>\n                <SideMenu />\n                <div id=\"dashboard\">\n                    <main>\n                        <div className='plot-area'>\n                            <Card className='section'>\n                                <div id='inner-plot-container'>\n                                    <Plot axisLabels={true} />\n                                </div>\n                            </Card>\n                        </div>\n                        <div className='timeline'>\n                            <IconButton className='play' disabled={plotType.name === 'line'}>\n                                <PlayIcon />\n                            </IconButton>\n                            <YearSlider />\n                        </div>\n                    </main>\n                    <aside>\n                        <Controls />\n                    </aside>\n                </div>\n            </Box>\n        </ThemeProvider>\n    );\n};\n\nconst myHistory = {\n    // eslint-disable-next-line no-restricted-globals\n    push: (location: Location) => history.pushState({}, null, location.href),\n    // eslint-disable-next-line no-restricted-globals\n    replace: (location: Location) => history.replaceState({}, null, location.href),\n};\n\nconst Dashboard = () => {\n    const plotType = useAppSelector(selectPlotType);\n    const controls = useAppSelector(selectControlFields);\n    const controlsIsReady = allValuesNotNull(controls);\n    return (\n        <>\n            {\n                controlsIsReady && plotType &&\n                <DumbDashboard plotType={plotType} controls={controls} />\n            }\n            <DataManager />\n            <QueryParamProvider history={myHistory}>\n                <Url />\n            </QueryParamProvider>\n        </>\n    );\n}\n\nconst DashboardApp = () => (\n    <Provider store={store}>\n        <Dashboard />\n    </Provider>\n)\n\nexport default DashboardApp;\n","\nexport const zipmap = (arr1 ,arr2) => arr1.reduce((p,c,i) => {\n    p[c] = arr2[i];\n    return p;\n},{});\n\nexport const getUrlParams = () : any => {\n    const url = decodeURI(window.location.href);\n    const question = url.indexOf(\"?\");\n    let hash = url.indexOf(\"#\");\n    if (hash === -1 && question === -1) return {};\n    if (hash === -1) hash = url.length;\n    const query = question === -1 || hash === question + 1 ? url.substring(hash) :\n        url.substring(question+1,hash);\n    let result = {};\n    query.split(\"&\").forEach(function(part) {\n        if (!part) return;\n        part = part.split(\"+\").join(\" \"); // replace every + with space, regexp-free version\n        const eq = part.indexOf(\"=\");\n        let key = eq>-1 ? part.substr(0,eq) : part;\n        const val = eq>-1 ? decodeURIComponent(part.substr(eq + 1)) : \"\";\n        const from = key.indexOf(\"[\");\n        if (from === -1) result[decodeURIComponent(key)] = val;\n        else {\n            const to = key.indexOf(\"]\",from);\n            const index = decodeURIComponent(key.substring(from + 1,to));\n            key = decodeURIComponent(key.substring(0, from));\n            if (!result[key]) result[key] = [];\n            if (!index) result[key].push(val);\n            else result[key][index] = val;\n        }\n    });\n    return result;\n}\n"],"sourceRoot":""}